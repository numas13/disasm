# vim: set expandtab ts=2 sts=2 sw=2:

##############################################################################
# Fields
##############################################################################

%base0        5:1 16:3
# NOTE: rex.X encoded in base[5] like in EVEX
%base         6:1 5:1 24:3

%reg          7:1 27:3

%mode         30:2

%bnd_base1    24:2
%bnd_reg1     27:2

##############################################################################
# Argument sets
##############################################################################

&segment    rw seg

&mem        rw mode b msz bsz
&mem_vec    rw mode b msz
&mem_bnd    rw mode b msz

&rm_rr      rw mode b r msz bsz rsz
&rm_rm      rw mode b r msz rsz
&rm_rx      rw mode r b msz rsz
&rm_mr      rw mode r b msz bsz
&rm_mx      rw mode r b msz
&rm_mm      rw mode r b msz
&rm_xr      rw mode r b msz bsz
&rm_xm      rw mode r b msz
&rm_xx      rw mode r b msz

&mr_rr      rw mode b r msz bsz rsz
&mr_rm      rw mode r b msz bsz
&mr_rx      rw mode r b msz bsz
&mr_mm      rw mode r b msz
&mr_xx      rw mode r b msz

&reg        rw reg rsz
&reg_vec    rw reg rsz

##############################################################################
# Formats
##############################################################################

# all formats
# modrm      | opcode |                |                     |              |
# -----------|--------|----------------|---------------------|--------------|
# mm rrr bbb | opcode | not used       | W f3 f2 66 rex 0 pp | RXB    mmmmm |
# mm rrr bbb | opcode | not used       | W         vvvv L pp | RXB    mmmmm | vex
# mm rrr bbb | opcode | z L'L b V' aaa | W         vvvv 1 pp | RXB R' 0 mmm | evex

# modrm      | opcode |                     |       map |
# -----------|--------|---------------------|-----------|
# mm rrr bbb | opcode | w f3 f2 66 rex 0 pp | rxb 00000 | # no escape
# mm rrr bbb | opcode | w f3 f2 66 rex 0 pp | rxb 00001 | # 0f
# mm rrr bbb | opcode | w f3 f2 66 rex 0 pp | rxb 00010 | # 0f 38
# mm rrr bbb | opcode | w f3 f2 66 rex 0 pp | rxb 00011 | # 0f 3a

@cs_r                      ........ . .... ... ... ..... &segment seg=0 rw=1
@ds_r                      ........ . .... ... ... ..... &segment seg=1 rw=1
@ss_r                      ........ . .... ... ... ..... &segment seg=2 rw=1
@es_r                      ........ . .... ... ... ..... &segment seg=3 rw=1
@fs_r                      ........ . .... ... ... ..... &segment seg=4 rw=1
@gs_r                      ........ . .... ... ... ..... &segment seg=5 rw=1

@cs_w                      ........ . .... ... ... ..... &segment seg=0 rw=2
@ds_w                      ........ . .... ... ... ..... &segment seg=1 rw=2
@ss_w                      ........ . .... ... ... ..... &segment seg=2 rw=2
@es_w                      ........ . .... ... ... ..... &segment seg=3 rw=2
@fs_w                      ........ . .... ... ... ..... &segment seg=4 rw=2
@gs_w                      ........ . .... ... ... ..... &segment seg=5 rw=2

@b_r                       ........ . .... ... ... ..... &mem mode=3 b=%base0 rw=3 msz=1 bsz=0

@r_r              ........ ........ . .... ... ... ..... &reg %reg rw=3 rsz=1
@r_m              ........ ........ . .... ... ... ..... &reg_vec %reg rw=3 rsz=64

@m_r              ........ ........ . .... ... ... ..... &mem %mode b=%base rw=3 msz=1 bsz=0
@m_m              ........ ........ . .... ... ... ..... m_m=&mem_vec %mode b=%base rw=3 msz=1
@m_x              ........ ........ . .... ... ... ..... m_x=&mem_vec %mode b=%base rw=3 msz=1

@xr_r             ........ ........ . .... ... ... ..... &reg_vec %reg rw=1 rsz=128
@xr_w             ........ ........ . .... ... ... ..... &reg_vec %reg rw=2 rsz=128
@xr_m             ........ ........ . .... ... ... ..... &reg_vec %reg rw=3 rsz=128

@xmm0             ........ ........ . .... ... ... ..... xmm=&reg_vec reg=0 rw=1 rsz=128

@st_m             ........ ........ . .... ... ... ..... st_m=1

@si_r             ........ ........ . .... ... ... ..... si_r=%base
@si_w             ........ ........ . .... ... ... ..... si_w=%base
@si_m             ........ ........ . .... ... ... ..... si_m=%base

@cr_r             ........ ........ . .... ... ... ..... cr_r=%reg
@cm_w             ........ ........ . .... ... ... ..... mode=%mode cmw=%base

@br_r             ........ ........ . .... ... ... ..... br_r=%bnd_reg1
@br_w             ........ ........ . .... ... ... ..... br_w=%bnd_reg1

@bm_r             ........ ........ . .... ... ... ..... &mem_bnd %mode b=%base rw=1 msz=1
@bm_w             ........ ........ . .... ... ... ..... &mem_bnd %mode b=%base rw=2 msz=1

@mr_rr            ........ ........ . .... ... ... ..... \
                  &mr_rr %mode b=%base r=%reg msz=1 bsz=0 rsz=1 rw=3

@rm_rr            ........ ........ . .... ... ... ..... \
                  &rm_rr %mode b=%base r=%reg msz=1 bsz=0 rsz=1 rw=3

@rm_rm            ........ ........ . .... ... ... ..... \
                  &rm_rm rw=3 %mode b=%base r=%reg msz=1 rsz=1

@a                ........ ........ . .... ... ... ..... \
                  &reg reg=0 rw=3 rsz=1

@shift1           ........ ........ . .... ... ... ..... \
                  &mem %mode b=%base rw=3 msz=1 bsz=0 i=1
@shift_cl         ........ ........ . .... ... ... ..... \
                  shift_cl=&mem %mode b=%base rw=3 msz=1 bsz=0

@rm_mm            ........ ........ ........ ........ \
                  &rm_mm rw=3 %mode r=%reg b=%base msz=1

@mr_mm            ........ ........ ........ ........ \
                  &mr_mm rw=3 %mode r=%reg b=%base msz=1

@mr_rm            ........ ........ ........ ........ \
                  &mr_rm rw=3 %mode r=%reg b=%base msz=1 bsz=0

@rm_mr            ........ ........ ........ ........ \
                  &rm_mr rw=3 %mode r=%reg b=%base msz=1 bsz=0

@rm_xx            ........ ........ ........ ........ \
                  &rm_xx rw=3 %mode r=%reg b=%base msz=1

@rm_xm            ........ ........ ........ ........ \
                  &rm_xm rw=3 %mode r=%reg b=%base msz=1

@rm_mx            ........ ........ ........ ........ \
                  &rm_mx rw=3 %mode r=%reg b=%base msz=1

@mr_xx            ........ ........ ........ ........ \
                  &mr_xx rw=2 %mode r=%reg b=%base msz=1

@rm_xr            ........ ........ ........ ........ \
                  &rm_xr rw=3 %mode r=%reg b=%base msz=1 bsz=0

@rm_rx            ........ ........ ........ ........ \
                  &rm_rx rw=3 %mode r=%reg b=%base msz=1 rsz=1

@mr_rx            ........ ........ ........ ........ \
                  &mr_rx rw=3 %mode r=%reg b=%base msz=1 bsz=0

##############################################################################
# 1-byte opcode map
##############################################################################

add               ........ 00000000 - ---- --- ... 00000 @mr_rr suffix=8 msz=8 rsz=8
add               ........ 00000001 - ---- --- ... 00000 @mr_rr suffix=1
add               ........ 00000010 - ---- --- ... 00000 @rm_rr suffix=8 msz=8 rsz=8
add               ........ 00000011 - ---- --- ... 00000 @rm_rr suffix=1
add                        00000100 - ---- --- ... 00000 @a uimm=8 suffix=8 rsz=8
add                        00000101 - ---- --- ... 00000 @a aimm=1 suffix=1

or                ........ 00001000 - ---- --- ... 00000 @mr_rr suffix=8 msz=8 rsz=8
or                ........ 00001001 - ---- --- ... 00000 @mr_rr suffix=1
or                ........ 00001010 - ---- --- ... 00000 @rm_rr suffix=8 msz=8 rsz=8
or                ........ 00001011 - ---- --- ... 00000 @rm_rr suffix=1
or                         00001100 - ---- --- ... 00000 @a uimm=8 suffix=8 rsz=8
or                         00001101 - ---- --- ... 00000 @a aimm=1 suffix=1

adc               ........ 00010000 - ---- --- ... 00000 @mr_rr suffix=8 msz=8 rsz=8
adc               ........ 00010001 - ---- --- ... 00000 @mr_rr suffix=1
adc               ........ 00010010 - ---- --- ... 00000 @rm_rr suffix=8 msz=8 rsz=8
adc               ........ 00010011 - ---- --- ... 00000 @rm_rr suffix=1
adc                        00010100 - ---- --- ... 00000 @a uimm=8 suffix=8 rsz=8
adc                        00010101 - ---- --- ... 00000 @a aimm=1 suffix=1

sbb               ........ 00011000 - ---- --- ... 00000 @mr_rr suffix=8 msz=8 rsz=8
sbb               ........ 00011001 - ---- --- ... 00000 @mr_rr suffix=1
sbb               ........ 00011010 - ---- --- ... 00000 @rm_rr suffix=8 msz=8 rsz=8
sbb               ........ 00011011 - ---- --- ... 00000 @rm_rr suffix=1
sbb                        00011100 - ---- --- ... 00000 @a uimm=8 suffix=8 rsz=8
sbb                        00011101 - ---- --- ... 00000 @a aimm=1 suffix=1

and               ........ 00100000 - ---- --- ... 00000 @mr_rr suffix=8 msz=8 rsz=8
and               ........ 00100001 - ---- --- ... 00000 @mr_rr suffix=1
and               ........ 00100010 - ---- --- ... 00000 @rm_rr suffix=8 msz=8 rsz=8
and               ........ 00100011 - ---- --- ... 00000 @rm_rr suffix=1
and                        00100100 - ---- --- ... 00000 @a uimm=8 suffix=8 rsz=8
and                        00100101 - ---- --- ... 00000 @a aimm=1 suffix=1

sub               ........ 00101000 - ---- --- ... 00000 @mr_rr suffix=8 msz=8 rsz=8
sub               ........ 00101001 - ---- --- ... 00000 @mr_rr suffix=1
sub               ........ 00101010 - ---- --- ... 00000 @rm_rr suffix=8 msz=8 rsz=8
sub               ........ 00101011 - ---- --- ... 00000 @rm_rr suffix=1
sub                        00101100 - ---- --- ... 00000 @a uimm=8 suffix=8 rsz=8
sub                        00101101 - ---- --- ... 00000 @a aimm=1 suffix=1

xor               ........ 00110000 - ---- --- ... 00000 @mr_rr suffix=8 msz=8 rsz=8
xor               ........ 00110001 - ---- --- ... 00000 @mr_rr suffix=1
xor               ........ 00110010 - ---- --- ... 00000 @rm_rr suffix=8 msz=8 rsz=8
xor               ........ 00110011 - ---- --- ... 00000 @rm_rr suffix=1
xor                        00110100 - ---- --- ... 00000 @a uimm=8 suffix=8 rsz=8
xor                        00110101 - ---- --- ... 00000 @a aimm=1 suffix=1

cmp               ........ 00111000 - ---- --- ... 00000 @mr_rr suffix=8 msz=8 rsz=8
cmp               ........ 00111001 - ---- --- ... 00000 @mr_rr suffix=1
cmp               ........ 00111010 - ---- --- ... 00000 @rm_rr suffix=8 msz=8 rsz=8
cmp               ........ 00111011 - ---- --- ... 00000 @rm_rr suffix=1
cmp                        00111100 - ---- --- ... 00000 @a uimm=8 suffix=8 rsz=8
cmp                        00111101 - ---- --- ... 00000 @a aimm=1 suffix=1

daa                        00100111 - ---- --- ... 00000 ? ~amd64
das                        00101111 - ---- --- ... 00000 ? ~amd64
aaa                        00110111 - ---- --- ... 00000 ? ~amd64
aas                        00111111 - ---- --- ... 00000 ? ~amd64

add               ..000... 10000000 - ---- --- ... 00000 @m_r uimm=8 suffix=8 msz=8
or                ..001... 10000000 - ---- --- ... 00000 @m_r uimm=8 suffix=8 msz=8
adc               ..010... 10000000 - ---- --- ... 00000 @m_r uimm=8 suffix=8 msz=8
sbb               ..011... 10000000 - ---- --- ... 00000 @m_r uimm=8 suffix=8 msz=8
and               ..100... 10000000 - ---- --- ... 00000 @m_r uimm=8 suffix=8 msz=8
sub               ..101... 10000000 - ---- --- ... 00000 @m_r uimm=8 suffix=8 msz=8
xor               ..110... 10000000 - ---- --- ... 00000 @m_r uimm=8 suffix=8 msz=8
cmp               ..111... 10000000 - ---- --- ... 00000 @m_r rw=1 uimm=8 suffix=8 msz=8

add               ..000... 10000001 - ---- --- ... 00000 @m_r aimm=1 suffix=1
or                ..001... 10000001 - ---- --- ... 00000 @m_r aimm=1 suffix=1
adc               ..010... 10000001 - ---- --- ... 00000 @m_r aimm=1 suffix=1
sbb               ..011... 10000001 - ---- --- ... 00000 @m_r aimm=1 suffix=1
and               ..100... 10000001 - ---- --- ... 00000 @m_r aimm=1 suffix=1
sub               ..101... 10000001 - ---- --- ... 00000 @m_r aimm=1 suffix=1
xor               ..110... 10000001 - ---- --- ... 00000 @m_r aimm=1 suffix=1
cmp               ..111... 10000001 - ---- --- ... 00000 @m_r rw=1 aimm=1 suffix=1

add               ..000... 10000011 - ---- --- ... 00000 @m_r simm=8 suffix=1
or                ..001... 10000011 - ---- --- ... 00000 @m_r simm=8 suffix=1
adc               ..010... 10000011 - ---- --- ... 00000 @m_r simm=8 suffix=1
sbb               ..011... 10000011 - ---- --- ... 00000 @m_r simm=8 suffix=1
and               ..100... 10000011 - ---- --- ... 00000 @m_r simm=8 suffix=1
sub               ..101... 10000011 - ---- --- ... 00000 @m_r simm=8 suffix=1
xor               ..110... 10000011 - ---- --- ... 00000 @m_r simm=8 suffix=1
cmp               ..111... 10000011 - ---- --- ... 00000 @m_r rw=1 simm=8 suffix=1

rol               ..000... 11000000 - ---- --- ... 00000 @m_r uimm=8 suffix=8 msz=8
ror               ..001... 11000000 - ---- --- ... 00000 @m_r uimm=8 suffix=8 msz=8
rcl               ..010... 11000000 - ---- --- ... 00000 @m_r uimm=8 suffix=8 msz=8
rcr               ..011... 11000000 - ---- --- ... 00000 @m_r uimm=8 suffix=8 msz=8
shl               ..100... 11000000 - ---- --- ... 00000 @m_r uimm=8 suffix=8 msz=8
shr               ..101... 11000000 - ---- --- ... 00000 @m_r uimm=8 suffix=8 msz=8
sar               ..111... 11000000 - ---- --- ... 00000 @m_r uimm=8 suffix=8 msz=8
rol               ..000... 11000001 - ---- --- ... 00000 @m_r uimm=8 suffix=1
ror               ..001... 11000001 - ---- --- ... 00000 @m_r uimm=8 suffix=1
rcl               ..010... 11000001 - ---- --- ... 00000 @m_r uimm=8 suffix=1
rcr               ..011... 11000001 - ---- --- ... 00000 @m_r uimm=8 suffix=1
shl               ..100... 11000001 - ---- --- ... 00000 @m_r uimm=8 suffix=1
shr               ..101... 11000001 - ---- --- ... 00000 @m_r uimm=8 suffix=1
sar               ..111... 11000001 - ---- --- ... 00000 @m_r uimm=8 suffix=1

rol               ..000... 11010000 - ---- --- ... 00000 @m_r i=1 suffix=8 msz=8
ror               ..001... 11010000 - ---- --- ... 00000 @m_r i=1 suffix=8 msz=8
rcl               ..010... 11010000 - ---- --- ... 00000 @m_r i=1 suffix=8 msz=8
rcr               ..011... 11010000 - ---- --- ... 00000 @m_r i=1 suffix=8 msz=8
shl               ..100... 11010000 - ---- --- ... 00000 @m_r i=1 suffix=8 msz=8
shr               ..101... 11010000 - ---- --- ... 00000 @m_r i=1 suffix=8 msz=8
sar               ..111... 11010000 - ---- --- ... 00000 @m_r i=1 suffix=8 msz=8

rol               ..000... 11010001 - ---- --- ... 00000 @shift1 suffix=1
ror               ..001... 11010001 - ---- --- ... 00000 @shift1 suffix=1
rcl               ..010... 11010001 - ---- --- ... 00000 @shift1 suffix=1
rcr               ..011... 11010001 - ---- --- ... 00000 @shift1 suffix=1
shl               ..100... 11010001 - ---- --- ... 00000 @shift1 suffix=1
shr               ..101... 11010001 - ---- --- ... 00000 @shift1 suffix=1
sar               ..111... 11010001 - ---- --- ... 00000 @shift1 suffix=1

rol               ..000... 11010010 - ---- --- ... 00000 @shift_cl suffix=8 msz=8
ror               ..001... 11010010 - ---- --- ... 00000 @shift_cl suffix=8 msz=8
rcl               ..010... 11010010 - ---- --- ... 00000 @shift_cl suffix=8 msz=8
rcr               ..011... 11010010 - ---- --- ... 00000 @shift_cl suffix=8 msz=8
shl               ..100... 11010010 - ---- --- ... 00000 @shift_cl suffix=8 msz=8
shr               ..101... 11010010 - ---- --- ... 00000 @shift_cl suffix=8 msz=8
sar               ..111... 11010010 - ---- --- ... 00000 @shift_cl suffix=8 msz=8

rol               ..000... 11010011 - ---- --- ... 00000 @shift_cl suffix=1
ror               ..001... 11010011 - ---- --- ... 00000 @shift_cl suffix=1
rcl               ..010... 11010011 - ---- --- ... 00000 @shift_cl suffix=1
rcr               ..011... 11010011 - ---- --- ... 00000 @shift_cl suffix=1
shl               ..100... 11010011 - ---- --- ... 00000 @shift_cl suffix=1
shr               ..101... 11010011 - ---- --- ... 00000 @shift_cl suffix=1
sar               ..111... 11010011 - ---- --- ... 00000 @shift_cl suffix=1

inc               ..000... 11111110 - ---- --- ... 00000 @m_r suffix=8 msz=8
dec               ..001... 11111110 - ---- --- ... 00000 @m_r suffix=8 msz=8
inc               ..000... 11111111 - ---- --- ... 00000 @m_r suffix=1
dec               ..001... 11111111 - ---- --- ... 00000 @m_r suffix=1
{
  inc                      01000... - ---- --- ... 00000 @b_r suffix=32 ? i386
  inc                      01000... - ---- --- ... 00000 @b_r suffix=16
}
{
  dec                      01001... - ---- --- ... 00000 @b_r suffix=32 ? i386
  dec                      01001... - ---- --- ... 00000 @b_r suffix=16
}

test              ........ 10000100 - ---- --- ... 00000 @mr_rr rw=1 suffix=8 msz=8 rsz=8
test              ........ 10000101 - ---- --- ... 00000 @mr_rr rw=1 suffix=1
test                       10101000 - ---- --- ... 00000 @a rw=1 uimm=8 suffix=8 rsz=8
test                       10101001 - ---- --- ... 00000 @a rw=1 aimm=2 suffix=1
test              ..000... 11110111 - ---- --- ... 00000 @m_r rw=1 aimm=2 suffix=1

test              ..000... 11110110 - ---- --- ... 00000 @m_r rw=1 suffix=8 msz=8 uimm=8
not               ..010... 11110110 - ---- --- ... 00000 @m_r suffix=8 msz=8
neg               ..011... 11110110 - ---- --- ... 00000 @m_r suffix=8 msz=8
mul               ..100... 11110110 - ---- --- ... 00000 @m_r suffix=8 msz=8
imul              ..101... 11110110 - ---- --- ... 00000 @m_r suffix=8 msz=8
div               ..110... 11110110 - ---- --- ... 00000 @m_r rw=2 suffix=8 msz=8
idiv              ..111... 11110110 - ---- --- ... 00000 @m_r rw=2 suffix=8 msz=8
not               ..010... 11110111 - ---- --- ... 00000 @m_r suffix=1
neg               ..011... 11110111 - ---- --- ... 00000 @m_r suffix=1
mul               ..100... 11110111 - ---- --- ... 00000 @m_r suffix=1
imul              ..101... 11110111 - ---- --- ... 00000 @m_r suffix=1
div               ..110... 11110111 - ---- --- ... 00000 @m_r rw=2 suffix=1
idiv              ..111... 11110111 - ---- --- ... 00000 @m_r rw=2 suffix=1

imul              ........ 01101001 - ---- --- ... 00000 @rm_rr rw=2 aimm=2 suffix=1
imul              ........ 01101011 - ---- --- ... 00000 @rm_rr rw=2 simm=8 suffix=1

sahf                       10011110 - ---- --- ... 00000

xchg              ........ 10000110 - ---- --- ... 00000 @m_r @r_r suffix=8 msz=8 rsz=8
xchg              ........ 10000111 - ---- --- ... 00000 @m_r @r_r suffix=1
pause                      10010000 - 1--- --- ... 00000
{
  nop                      10010000 - 0-0- --- ... 00000 ? alias
  xchg                     10010... - 0--- --- ... 00000 @b_r @a suffix=1
}

{
  cbtw                     10011000 0 --1- --- ... 00000 ? att
  cbw                      10011000 0 --1- --- ... 00000
}
{
  cwtl                     10011000 0 --0- --- ... 00000 ? att
  cwde                     10011000 0 --0- --- ... 00000
}
{
  cltq                     10011000 1 ---- --- ... 00000 ? att
  cdqe                     10011000 1 ---- --- ... 00000
}
{
  cwtd                     10011001 0 --1- --- ... 00000 ? att
  cwd                      10011001 0 --1- --- ... 00000
}
{
  cltd                     10011001 0 --0- --- ... 00000 ? att
  cdq                      10011001 0 --0- --- ... 00000
}
{
  cqto                     10011001 1 ---- --- ... 00000 ? att
  cqo                      10011001 1 ---- --- ... 00000
}

{
  arpl            ........ 01100011 - ---- --- ... 00000 @mr_rr rw=2 msz=16 ? ~amd64
  movslq          ........ 01100011 1 ---- --- ... 00000 @rm_rr rw=2 msz=32 ? att
  movsxd          ........ 01100011 1 ---- --- ... 00000 @rm_rr rw=2 msz=32
}
mov               ........ 10001000 - ---- --- ... 00000 @mr_rr rw=2 suffix=8 msz=8 rsz=8
mov               ........ 10001001 - ---- --- ... 00000 @mr_rr rw=2 suffix=1
mov               ........ 10001010 - ---- --- ... 00000 @rm_rr rw=2 suffix=8 msz=8 rsz=8
mov               ........ 10001011 - ---- --- ... 00000 @rm_rr rw=2 suffix=1
mov                        10110... - ---- --- ... 00000 @b_r rw=2 uimm=8 suffix=8 msz=8
movabs                     10111... 1 ---- --- ... 00000 @b_r rw=2 uimm=1 suffix=1
mov                        10111... 0 ---- --- ... 00000 @b_r rw=2 uimm=1 suffix=1
mov               ..000... 11000110 - ---- --- ... 00000 @m_r rw=2 uimm=8 suffix=8 msz=8
mov               ..000... 11000111 - ---- --- ... 00000 @m_r rw=2 aimm=2 suffix=1

mov                        10100000 - ---- --- ... 00000 @a rw=2 moffs_ro=8 suffix=8 rsz=8
mov                        10100001 . --.- --- ... 00000 @a rw=2 moffs_ro=1 suffix=1
mov                        10100010 - ---- --- ... 00000 moffs_wr=8 @a rw=1 suffix=8 rsz=8
mov                        10100011 . --.- --- ... 00000 moffs_wr=1 @a rw=1 suffix=1

lea               ........ 10001101 - ---- --- ... 00000 @rm_rr rw=2 suffix=1

push                       01010... - --1- --- ... 00000 @b_r rw=1 msz=16 suffix=1
push                       01010... - --0- --- ... 00000 @b_r rw=1 msz=4  suffix=1
pushw                      01101000 - --1- --- ... 00000 uimm=16
{
  push                     01101000 - --0- --- ... 00000 simm64=32 suffix_lazy=64 ? amd64
  push                     01101000 - --0- --- ... 00000 simm32=32 suffix_lazy=32
}
pushw                      01101010 - --1- --- ... 00000 simm=8
{
  push                     01101010 - --0- --- ... 00000 simm64=8 suffix_lazy=64 ? amd64
  push                     01101010 - --0- --- ... 00000 simm32=8 suffix_lazy=32
}
push              ..110... 11111111 - --1- --- ... 00000 @m_r msz=16 suffix=-16
push              ..110... 11111111 - --0- --- ... 00000 @m_r msz=4  suffix_lazy=1

push                       00001110 - ---- --- ... 00000 @cs_r ? ~amd64
push                       00010110 - ---- --- ... 00000 @ss_r ? ~amd64
push                       00011110 - ---- --- ... 00000 @ds_r ? ~amd64
push                       00000110 - ---- --- ... 00000 @es_r ? ~amd64

pop                        01011... - --1- --- ... 00000 @b_r msz=16 suffix=1
pop                        01011... - --0- --- ... 00000 @b_r msz=4  suffix=1
pop               ..000... 10001111 - --1- --- ... 00000 @m_r rw=2 msz=16 suffix=1
pop               ..000... 10001111 - --0- --- ... 00000 @m_r rw=2 msz=4  suffix=1

pop                        00000111 - ---- --- ... 00000 @es_w ? ~amd64
pop                        00010111 - ---- --- ... 00000 @ss_w ? ~amd64
pop                        00011111 - ---- --- ... 00000 @ds_w ? ~amd64

pushfw                     10011100 - --1- --- ... 00000
{
  pushfq                   10011100 - --0- --- ... 00000 ? att amd64
  pushf                    10011100 - --0- --- ... 00000
}
popfw                      10011101 - --1- --- ... 00000
{
  popfq                    10011101 - --0- --- ... 00000 ? att amd64
  popf                     10011101 - --0- --- ... 00000
}

{
  pushad                   01100000 - ---- --- ... 00000 ? ~amd64 att
  pusha                    01100000 - ---- --- ... 00000 ? ~amd64
}
{
  popad                    01100001 - ---- --- ... 00000 ? ~amd64 att
  popa                     01100001 - ---- --- ... 00000 ? ~amd64
}

bound             ........ 01100010 - --0- --- ... 00000 @rm_rr rw=1 suffix=1 msz=64 rsz=32 ? ~amd64
bound             ........ 01100010 - --1- --- ... 00000 @rm_rr rw=1 suffix=1 msz=32 rsz=16 ? ~amd64

jo                         01110000 - ---- --- ... 00000 rel=8
jno                        01110001 - ---- --- ... 00000 rel=8
{
  jb                       01110010 - ---- --- ... 00000 rel=8
# jnae                     01110010 - ---- --- ... 00000 rel=8
# jc                       01110010 - ---- --- ... 00000 rel=8
}
{
  jae                      01110011 - ---- --- ... 00000 rel=8
# jnb                      01110011 - ---- --- ... 00000 rel=8
# jnc                      01110011 - ---- --- ... 00000 rel=8
}
{
  je                       01110100 - ---- --- ... 00000 rel=8
# jz                       01110100 - ---- --- ... 00000 rel=8
}
{
  jne                      01110101 - ---- --- ... 00000 rel=8
# jnz                      01110101 - ---- --- ... 00000 rel=8
}
{
  jbe                      01110110 - ---- --- ... 00000 rel=8
# jna                      01110110 - ---- --- ... 00000 rel=8
}
{
  ja                       01110111 - ---- --- ... 00000 rel=8
# jnbe                     01110111 - ---- --- ... 00000 rel=8
}
js                         01111000 - ---- --- ... 00000 rel=8
jns                        01111001 - ---- --- ... 00000 rel=8
{
  jp                       01111010 - ---- --- ... 00000 rel=8
# jpe                      01111010 - ---- --- ... 00000 rel=8
}
{
  jnp                      01111011 - ---- --- ... 00000 rel=8
# jpo                      01111011 - ---- --- ... 00000 rel=8
}
{
  jl                       01111100 - ---- --- ... 00000 rel=8
# jnge                     01111100 - ---- --- ... 00000 rel=8
}
{
  jge                      01111101 - ---- --- ... 00000 rel=8
# jnl                      01111101 - ---- --- ... 00000 rel=8
}
{
  jle                      01111110 - ---- --- ... 00000 rel=8
# jng                      01111110 - ---- --- ... 00000 rel=8
}
{
  jg                       01111111 - ---- --- ... 00000 rel=8
# jnle                     01111111 - ---- --- ... 00000 rel=8
}

jmp                        11101001 - --1- --- ... 00000 rel=16 suffix=16
{
  jmp                      11101001 - --0- --- ... 00000 rel=32 suffix=64 ? amd64
  jmp                      11101001 - --0- --- ... 00000 rel=32 suffix=32
}
jmp                        11101011 - ---- --- ... 00000 rel=8
jmp               ..100... 11111111 - --1- --- ... 00000 indirect=1 @m_r rw=1 msz=16 suffix=-16
{
  jmp             ..100... 11111111 - --0- --- ... 00000 indirect=1 @m_r rw=1 msz=64 suffix_lazy=1 ? amd64
  jmp             ..100... 11111111 - --0- --- ... 00000 indirect=1 @m_r rw=1 msz=32 suffix_lazy=1
}
jmp               0.101... 11111111 - --1- --- ... 00000 @m_r rw=1 msz=32
jmp               0.101... 11111111 0 --0- --- ... 00000 @m_r rw=1 msz=16
jmp               0.101... 11111111 1 --0- --- ... 00000 @m_r rw=1 msz=80 rex_w=1
jmp               10101... 11111111 - --1- --- ... 00000 @m_r rw=1 msz=32
jmp               10101... 11111111 0 --0- --- ... 00000 @m_r rw=1 msz=16
jmp               10101... 11111111 1 --0- --- ... 00000 @m_r rw=1 msz=80 rex_w=1

{
  jecxz                    11100011 - ---- --- ... 00000 rel=8 ? prefix_67
  jrcxz                    11100011 - ---- --- ... 00000 rel=8 ? amd64
  jcxz                     11100011 - ---- --- ... 00000 rel=8
}

ret                        11000010 - --0- --- ... 00000 uimm=16 suffix_lazy=4
retw                       11000010 - --1- --- ... 00000 uimm=16
# TODO: mpx ret
ret                        11000011 - --0- --- ... 00000 rep=2 suffix_lazy=4
retw                       11000011 - --1- --- ... 00000 rep=2
{
  lretl                    11001010 - --0- --- ... 00000 uimm=16 ? att
  retf                     11001010 - --0- --- ... 00000 uimm=16
}
{
  lretl                    11001011 - --0- --- ... 00000 ? att
  retf                     11001011 - --0- --- ... 00000
}
iret                       11001111 0 ---- --- ... 00000
iretq                      11001111 1 ---- --- ... 00000

callw                      11101000 0 --1- --- ... 00000 rel=16
call                       11101000 0 --0- --- ... 00000 rel=32 suffix=32
call                       11101000 1 ---- --- ... 00000 rel=32 suffix=32 rex_w=1
call              ..010... 11111111 - --1- --- ... 00000 indirect=1 @m_r rw=1 msz=16 suffix_lazy=1
call              ..010... 11111111 - --0- --- ... 00000 indirect=1 @m_r rw=1 msz=4  suffix_lazy=4
{
  lcall           ..011... 11111111 - ---- --- ... 00000 @m_r rw=1 msz=4  suffix=1 ? att
  call            ..011... 11111111 1 ---- --- ... 00000 @m_r rw=1 msz=80 rex_w=1
  call            ..011... 11111111 - --0- --- ... 00000 @m_r rw=1 msz=48
  call            ..011... 11111111 - --1- --- ... 00000 @m_r rw=1 msz=32
}

{
  loopne                   11100000 - ---- --- ... 00000 rel=8
# loopnz                   11100000 - ---- --- ... 00000 rel=8
}
{
  loope                    11100001 - ---- --- ... 00000 rel=8
# loopz                    11100001 - ---- --- ... 00000 rel=8
}
loop                       11100010 - ---- --- ... 00000 rel=8

movs                       10100100 - ---- --- ... 00000 rep=1 movs=8
movs                       10100101 - ---- --- ... 00000 rep=1 movs=1
cmps                       10100110 - ---- --- ... 00000 rep=2 cmps=8
cmps                       10100111 - ---- --- ... 00000 rep=2 cmps=1
stos                       10101010 - ---- --- ... 00000 rep=1 stos=8
stos                       10101011 - ---- --- ... 00000 rep=1 stos=1
lods                       10101100 - ---- --- ... 00000 rep=1 lods=8
lods                       10101101 - ---- --- ... 00000 rep=1 lods=1
scas                       10101110 - ---- --- ... 00000 rep=2 scas=8
scas                       10101111 - ---- --- ... 00000 rep=2 scas=1

in                         11100100 - ---0 --- ... 00000 @a rw=2 uimm=8 suffix=8 rsz=8
in                         11100101 - ---0 --- ... 00000 @a rw=2 uimm=8 suffix=1
in                         11101100 - ---0 --- ... 00000 @mr_rr rw=2 mode=3 b=0 msz=8  r=2 rsz=16 suffix=8
in                         11101101 - --00 --- ... 00000 @mr_rr rw=2 mode=3 b=0 msz=32 r=2 rsz=16 suffix=16
in                         11101101 - --10 --- ... 00000 @mr_rr rw=2 mode=3 b=0 msz=16 r=2 rsz=16 suffix=32

out                        11100110 - ---0 --- ... 00000 uimm=8 @a rw=1 suffix=8 rsz=8
out                        11100111 - ---0 --- ... 00000 uimm=8 @a rw=1 suffix=1
out                        11101110 - ---0 --- ... 00000 @rm_rr rw=1 r=2 rsz=16 mode=3 b=0 msz=8  suffix=8
out                        11101111 - --00 --- ... 00000 @rm_rr rw=1 r=2 rsz=16 mode=3 b=0 msz=32 suffix=16
out                        11101111 - --10 --- ... 00000 @rm_rr rw=1 r=2 rsz=16 mode=3 b=0 msz=16 suffix=32

ins                        01101100 - ---0 --- ... 00000 rep=1 es=1 @mr_rr rw=2 mode=0 b=7 msz=8  r=2 rsz=16 suffix=8
ins                        01101101 - --00 --- ... 00000 rep=1 es=1 @mr_rr rw=2 mode=0 b=7 msz=32 r=2 rsz=16 suffix=32
ins                        01101101 - --10 --- ... 00000 rep=1 es=1 @mr_rr rw=2 mode=0 b=7 msz=16 r=2 rsz=16 suffix=16

outs                       01101110 - ---0 --- ... 00000 rep=1 ds=1 @rm_rr rw=1 r=2 rsz=16 mode=0 b=6 msz=8  suffix=8
outs                       01101111 - --00 --- ... 00000 rep=1 ds=1 @rm_rr rw=1 r=2 rsz=16 mode=0 b=6 msz=32 suffix=32
outs                       01101111 - --10 --- ... 00000 rep=1 ds=1 @rm_rr rw=1 r=2 rsz=16 mode=0 b=6 msz=16 suffix=16

aam                        11010100 - ---- --- ... 00000 uimm=8  ? ~amd64
aad                        11010101 - ---- --- ... 00000 uimm=8  ? ~amd64

lahf                       10011111 - ---- --- ... 00000

enter                      11001000 - ---- --- ... 00000 uimm=16 uimm2=8 suffix=2
leave                      11001001 - ---- --- ... 00000 suffix=2
int3                       11001100 - ---- --- ... 00000
int                        11001101 - ---- --- ... 00000 uimm=8
into                       11001110 - ---- --- ... 00000 ? ~amd64
xlat                       11010111 - ---- --- ... 00000 ds=1 @m_r rw=1 mode=0 b=3 msz=8 rex_w=1
int1                       11110001 - ---- --- ... 00000
hlt                        11110100 - ---- --- ... 00000
cmc                        11110101 - ---- --- ... 00000
clc                        11111000 - ---- --- ... 00000
stc                        11111001 - ---- --- ... 00000
cli                        11111010 - ---- --- ... 00000
sti                        11111011 - ---- --- ... 00000
cld                        11111100 - ---- --- ... 00000
std                        11111101 - ---- --- ... 00000

##############################################################################
# 2-byte opcode map (0f opcode)
##############################################################################

push                       10100000 - ---- --- ... 00001 @fs_r
push                       10101000 - ---- --- ... 00001 @gs_r

pop                        10100001 - ---- --- ... 00001 @fs_w
pop                        10101001 - ---- --- ... 00001 @gs_w

{
  lldt            11010... 00000000 - ---- --- ... 00001 @m_r rw=1 msz=32
  lldt            ..010... 00000000 - ---- --- ... 00001 @m_r rw=1 msz=16
}
{
  ltr             11011... 00000000 - ---- --- ... 00001 @m_r rw=1 msz=32
  ltr             ..011... 00000000 - ---- --- ... 00001 @m_r rw=1 msz=16
}
{
  lgdt            0.010... 00000001 - ---- --- ... 00001 no_ptr=1 @m_r rw=1 msz=80 ? amd64
  lgdt            0.010... 00000001 - ---- --- ... 00001 no_ptr=1 @m_r rw=1 msz=48
}
{
  lgdt            10010... 00000001 - ---- --- ... 00001 no_ptr=1 @m_r rw=1 msz=80 ? amd64
  lgdt            10010... 00000001 - ---- --- ... 00001 no_ptr=1 @m_r rw=1 msz=48
}
{
  lidt            0.011... 00000001 - ---- --- ... 00001 no_ptr=1 @m_r rw=1 msz=80 ? amd64
  lidt            0.011... 00000001 - ---- --- ... 00001 no_ptr=1 @m_r rw=1 msz=48
}
{
  lidt            10011... 00000001 - ---- --- ... 00001 no_ptr=1 @m_r rw=1 msz=80 ? amd64
  lidt            10011... 00000001 - ---- --- ... 00001 no_ptr=1 @m_r rw=1 msz=48
}
lmsw              ..110... 00000001 - ---- --- ... 00001 @m_r rw=1 msz=16

invlpg            0.111... 00000001 - ---- --- ... 00001 @m_r rw=1 msz=8
invlpg            10111... 00000001 - ---- --- ... 00001 @m_r rw=1 msz=8

clts                       00000110 - ---- --- ... 00001
invd                       00001000 - ---- --- ... 00001

# TODO:
#mov              ........ 00100000 - ---- --- ... 00001 @m_r rw=2 @cr_r msz=5
#mov              ........ 00100010 - ---- --- ... 00001 @cm_w @r_r rw=1 rsz=5

lar               ........ 00000010 - --1- --- ... 00001 @rm_rr rw=2 rsz=16 msz=16
{
  lar             11...... 00000010 - --0- --- ... 00001 @rm_rr rw=2 rsz=32 msz=32
  lar             ........ 00000010 - --0- --- ... 00001 @rm_rr rw=2 rsz=32 msz=16
}

lsl               ........ 00000011 0 --1- --- ... 00001 @rm_rr rw=2 rsz=16 msz=16
{
  lsl             11...... 00000011 0 --0- --- ... 00001 @rm_rr rw=2 rsz=32 msz=32
  lsl             ........ 00000011 0 --0- --- ... 00001 @rm_rr rw=2 rsz=32 msz=16
}
{
  lsl             11...... 00000011 1 --0- --- ... 00001 @rm_rr rw=2 rsz=64 msz=32
  lsl             ........ 00000011 1 --0- --- ... 00001 @rm_rr rw=2 rsz=64 msz=16
}

ud0               ........ 11111111 - 000- --- ... 00001 @rm_rr rw=1 rsz=32 msz=32
ud1               ........ 10111001 - 000- --- ... 00001 @rm_rr rw=1 rsz=32 msz=32

shld              ........ 10100100 - 00.- --- ... 00001 @mr_rr rw=2 uimm=8 suffix=1
shld              ........ 10100101 - 00.- --- ... 00001 @mr_rr rw=2 rb=1 suffix=1
shrd              ........ 10101100 - 00.- --- ... 00001 @mr_rr rw=2 uimm=8 suffix=1
shrd              ........ 10101101 - 00.- --- ... 00001 @mr_rr rw=2 rb=1 suffix=1
imul              ........ 10101111 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1
bswap                      11001... - 000- --- ... 00001 @b_r

cmpxchg           ........ 10110000 - 000- --- ... 00001 @mr_rr suffix=8 msz=8 rsz=8
cmpxchg           ........ 10110001 - 00-- --- ... 00001 @mr_rr suffix=1
xadd              ........ 11000000 - 000- --- ... 00001 @mr_rr suffix=8 msz=8 rsz=8
xadd              ........ 11000001 - 00-- --- ... 00001 @mr_rr suffix=1

lss               ........ 10110010 0 --1- --- ... 00001 @rm_rr rw=2 rsz=16 msz=32
lss               ........ 10110010 0 --0- --- ... 00001 @rm_rr rw=2 rsz=32 msz=48
lss               ........ 10110010 1 --0- --- ... 00001 @rm_rr rw=2 rsz=64 msz=80

lfs               ........ 10110100 0 --1- --- ... 00001 @rm_rr rw=2 rsz=16 msz=32
lfs               ........ 10110100 0 --0- --- ... 00001 @rm_rr rw=2 rsz=32 msz=48
lfs               ........ 10110100 1 --0- --- ... 00001 @rm_rr rw=2 rsz=64 msz=80

lgs               ........ 10110101 0 --1- --- ... 00001 @rm_rr rw=2 rsz=16 msz=32
lgs               ........ 10110101 0 --0- --- ... 00001 @rm_rr rw=2 rsz=32 msz=48
lgs               ........ 10110101 1 --0- --- ... 00001 @rm_rr rw=2 rsz=64 msz=80

{
  movzb           ........ 10110110 - 00-- --- ... 00001 @rm_rr rw=2 msz=8 suffix=-1 ? att
  movzx           ........ 10110110 - 00-- --- ... 00001 @rm_rr rw=2 msz=8 suffix=1
}
{
  movzw           ........ 10110111 - 000- --- ... 00001 @rm_rr rw=2 msz=16 suffix=-1 ? att
  movzx           ........ 10110111 - 000- --- ... 00001 @rm_rr rw=2 msz=16 suffix=1
}
{
  movsb           ........ 10111110 - 00-- --- ... 00001 @rm_rr rw=2 msz=8 suffix=-1 ? att
  movsx           ........ 10111110 - 00-- --- ... 00001 @rm_rr rw=2 msz=8 suffix=1
}
{
  movsw           ........ 10111111 - 000- --- ... 00001 @rm_rr rw=2 msz=16 suffix=-1 ? att
  movsx           ........ 10111111 - 000- --- ... 00001 @rm_rr rw=2 msz=16 suffix=1
}

bt                ........ 10100011 - 00-- --- ... 00001 @mr_rr suffix=1 rw=1
bts               ........ 10101011 - 00-- --- ... 00001 @mr_rr suffix=1
btr               ........ 10110011 - 00-- --- ... 00001 @mr_rr suffix=1
btc               ........ 10111011 - 00-- --- ... 00001 @mr_rr suffix=1
bt                ..100... 10111010 - 00-- --- ... 00001 @m_r rw=1 uimm=8 suffix=1
btr               ..110... 10111010 - 00-- --- ... 00001 @m_r uimm=8 suffix=1
bts               ..101... 10111010 - 00-- --- ... 00001 @m_r uimm=8 suffix=1
btc               ..111... 10111010 - 00-- --- ... 00001 @m_r uimm=8 suffix=1
bsf               ........ 10111100 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1
bsr               ........ 10111101 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1

jo                         10000000 - 000- --- ... 00001 rel=0
jno                        10000001 - 000- --- ... 00001 rel=0
{
  jb                       10000010 - 000- --- ... 00001 rel=0
# jnae                     10000010 - 000- --- ... 00001 rel=0
# jc                       10000010 - 000- --- ... 00001 rel=0
}
{
  jae                      10000011 - 000- --- ... 00001 rel=0
# jnb                      10000011 - 000- --- ... 00001 rel=0
# jnc                      10000011 - 000- --- ... 00001 rel=0
}
{
  je                       10000100 - 000- --- ... 00001 rel=0
# jz                       10000100 - 000- --- ... 00001 rel=0
}
{
  jne                      10000101 - 000- --- ... 00001 rel=0
# jnz                      10000101 - 000- --- ... 00001 rel=0
}
{
  jbe                      10000110 - 000- --- ... 00001 rel=0
# jna                      10000110 - 000- --- ... 00001 rel=0
}
{
  ja                       10000111 - 000- --- ... 00001 rel=0
# jnbe                     10000111 - 000- --- ... 00001 rel=0
}
js                         10001000 - 000- --- ... 00001 rel=0
jns                        10001001 - 000- --- ... 00001 rel=0
{
  jp                       10001010 - 000- --- ... 00001 rel=0
# jpe                      10001010 - 000- --- ... 00001 rel=0
}
{
  jnp                      10001011 - 000- --- ... 00001 rel=0
# jpo                      10001011 - 000- --- ... 00001 rel=0
}
{
  jl                       10001100 - 000- --- ... 00001 rel=0
# jnge                     10001100 - 000- --- ... 00001 rel=0
}
{
  jge                      10001101 - 000- --- ... 00001 rel=0
# jnl                      10001101 - 000- --- ... 00001 rel=0
}
{
  jle                      10001110 - 000- --- ... 00001 rel=0
# jng                      10001110 - 000- --- ... 00001 rel=0
}
{
  jg                       10001111 - 000- --- ... 00001 rel=0
# jnle                     10001111 - 000- --- ... 00001 rel=0
}

seto              ..000... 10010000 - 000- --- ... 00001 @m_r rw=2 msz=8
setno             ..000... 10010001 - 000- --- ... 00001 @m_r rw=2 msz=8
{
  setb            ..000... 10010010 - 000- --- ... 00001 @m_r rw=2 msz=8
# setc            ..000... 10010010 - 000- --- ... 00001 @m_r rw=2 msz=8
# setnae          ..000... 10010010 - 000- --- ... 00001 @m_r rw=2 msz=8
}
{
  setae           ..000... 10010011 - 000- --- ... 00001 @m_r rw=2 msz=8
# setnb           ..000... 10010011 - 000- --- ... 00001 @m_r rw=2 msz=8
# setnc           ..000... 10010011 - 000- --- ... 00001 @m_r rw=2 msz=8
}
{
  sete            ..000... 10010100 - 000- --- ... 00001 @m_r rw=2 msz=8
# setz            ..000... 10010100 - 000- --- ... 00001 @m_r rw=2 msz=8
}
{
  setne           ..000... 10010101 - 000- --- ... 00001 @m_r rw=2 msz=8
# setnz           ..000... 10010101 - 000- --- ... 00001 @m_r rw=2 msz=8
}
{
  setbe           ..000... 10010110 - 000- --- ... 00001 @m_r rw=2 msz=8
# setna           ..000... 10010110 - 000- --- ... 00001 @m_r rw=2 msz=8
}
{
  seta            ..000... 10010111 - 000- --- ... 00001 @m_r rw=2 msz=8
# setnbe          ..000... 10010111 - 000- --- ... 00001 @m_r rw=2 msz=8
}
sets              ..000... 10011000 - 000- --- ... 00001 @m_r rw=2 msz=8
setns             ..000... 10011001 - 000- --- ... 00001 @m_r rw=2 msz=8
{
  setp            ..000... 10011010 - 000- --- ... 00001 @m_r rw=2 msz=8
# setpe           ..000... 10011010 - 000- --- ... 00001 @m_r rw=2 msz=8
}
{
  setnp           ..000... 10011011 - 000- --- ... 00001 @m_r rw=2 msz=8
# setpo           ..000... 10011011 - 000- --- ... 00001 @m_r rw=2 msz=8
}
{
  setl            ..000... 10011100 - 000- --- ... 00001 @m_r rw=2 msz=8
# setnge          ..000... 10011100 - 000- --- ... 00001 @m_r rw=2 msz=8
}
{
  setge           ..000... 10011101 - 000- --- ... 00001 @m_r rw=2 msz=8
# setnl           ..000... 10011101 - 000- --- ... 00001 @m_r rw=2 msz=8
}
{
  setle           ..000... 10011110 - 000- --- ... 00001 @m_r rw=2 msz=8
# setng           ..000... 10011110 - 000- --- ... 00001 @m_r rw=2 msz=8
}
{
  setg            ..000... 10011111 - 000- --- ... 00001 @m_r rw=2 msz=8
# setnle          ..000... 10011111 - 000- --- ... 00001 @m_r rw=2 msz=8
}

cmovo             ........ 01000000 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
cmovno            ........ 01000001 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
{
  cmovb           ........ 01000010 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
# cmovc           ........ 01000010 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
# cmovnae         ........ 01000010 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
}
{
  cmovae          ........ 01000011 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
# cmovnc          ........ 01000011 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
# cmovnb          ........ 01000011 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
}
{
  cmove           ........ 01000100 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
# cmovz           ........ 01000100 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
}
{
  cmovne          ........ 01000101 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
# cmovnz          ........ 01000101 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
}
{
  cmovbe          ........ 01000110 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
# cmovna          ........ 01000110 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
}
{
  cmova           ........ 01000111 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
# cmovnbe         ........ 01000111 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
}
cmovs             ........ 01001000 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
cmovns            ........ 01001001 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
{
  cmovp           ........ 01001010 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
# cmovpe          ........ 01001010 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
}
{
  cmovnp          ........ 01001011 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
# cmovpo          ........ 01001011 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
}
{
  cmovl           ........ 01001100 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
# cmovnge         ........ 01001100 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
}
{
  cmovge          ........ 01001101 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
# cmovnl          ........ 01001101 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
}
{
  cmovle          ........ 01001110 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
# cmovng          ........ 01001110 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
}
{
  cmovg           ........ 01001111 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
# cmovnle         ........ 01001111 - 00-- --- ... 00001 @rm_rr rw=2 suffix=1 ? cmov
}

##############################################################################
# 3-byte opcode map (0f 38 opcode)
##############################################################################

crc32             ........ 11110000 - -1-- --- ... 00010 @rm_rr rsz=3 msz=8
crc32             ........ 11110001 - -1-- --- ... 00010 @rm_rr rsz=3 msz=1

invpcid           ........ 10000010 - --1- --- ... 00010 no_ptr=1 @rm_rr rw=1 rsz=5 msz=8

##############################################################################
# 3-byte opcode map (0f 3a opcode)
##############################################################################

##############################################################################
# Extension x87
##############################################################################

emms                       01110111 - ---- -00 ... 00001 ? x87
fxsave            ..000... 10101110 0 ---- -00 ... 00001 no_ptr=1 @m_r rw=2 msz=512 ? x87
fxsave64          ..000... 10101110 1 ---- -00 ... 00001 no_ptr=1 @m_r rw=2 msz=512 ? x87
fxrstor           ..001... 10101110 0 ---- -00 ... 00001 no_ptr=1 @m_r rw=1 msz=512 ? x87
fxrstor64         ..001... 10101110 1 ---- -00 ... 00001 no_ptr=1 @m_r rw=1 msz=512 ? x87

{
  fadd            11000... 11011000 - ---- --- ... 00000 @st_m @si_r ? x87
  fadd            ..000... 11011000 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=1 ? x87
}
{
  fmul            11001... 11011000 - ---- --- ... 00000 @st_m @si_r ? x87
  fmul            ..001... 11011000 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=1 ? x87
}
{
  fcom            11010... 11011000 - ---- --- ... 00000 @si_r ? x87
  fcom            ..010... 11011000 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=1 ? x87
}
{
  fcomp           11011... 11011000 - ---- --- ... 00000 @si_r ? x87
  fcomp           ..011... 11011000 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=1 ? x87
}
{
  fcom            11010... 11011100 - ---- --- ... 00000 @si_r ? x87
  fcom            ..010... 11011100 - ---- --- ... 00000 @m_r rw=1 msz=64 fp_suffix=1 ? x87
}
fcomp             0.011... 11011100 - ---- --- ... 00000 @m_r rw=1 msz=64 fp_suffix=1 ? x87
fcomp             10011... 11011100 - ---- --- ... 00000 @m_r rw=1 msz=64 fp_suffix=1 ? x87
{
  fcompp          11011001 11011110 - ---- --- ... 00000 ? x87
  ficomp          ..011... 11011110 - ---- --- ... 00000 @m_r rw=1 msz=16 fp_suffix=32 ? x87
}
{
  fsub            11100... 11011000 - ---- --- ... 00000 @st_m @si_r ? x87
  fsub            ..100... 11011000 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=1 ? x87
}
{
  fsubr           11101... 11011000 - ---- --- ... 00000 @st_m @si_r ? x87
  fsubr           ..101... 11011000 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=1 ? x87
}
{
  fdiv            11110... 11011000 - ---- --- ... 00000 @st_m @si_r ? x87
  fdiv            ..110... 11011000 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=1 ? x87
}
{
  fdivr           11111... 11011000 - ---- --- ... 00000 @st_m @si_r ? x87
  fdivr           ..111... 11011000 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=1 ? x87
}
fxch              11001... 11011001 - ---- --- ... 00000 @si_r ? x87
fldenv            0.100... 11011001 - ---- --- ... 00000 no_ptr=1 @m_r rw=1 ? x87
fldenv            10100... 11011001 - ---- --- ... 00000 no_ptr=1 @m_r rw=1 ? x87
fchs              11100000 11011001 - ---- --- ... 00000 ? x87
fabs              11100001 11011001 - ---- --- ... 00000 ? x87
ftst              11100100 11011001 - ---- --- ... 00000 ? x87
fxam              11100101 11011001 - ---- --- ... 00000 ? x87
fnstenv           0.110... 11011001 - ---- --- ... 00000 no_ptr=1 @m_r rw=1 ? x87
fnstenv           10110... 11011001 - ---- --- ... 00000 no_ptr=1 @m_r rw=1 ? x87
f2xm1             11110000 11011001 - ---- --- ... 00000 ? x87
fyl2x             11110001 11011001 - ---- --- ... 00000 ? x87
fptan             11110010 11011001 - ---- --- ... 00000 ? x87
fpatan            11110011 11011001 - ---- --- ... 00000 ? x87
fxtract           11110100 11011001 - ---- --- ... 00000 ? x87
fprem1            11110101 11011001 - ---- --- ... 00000 ? x87
fdecstp           11110110 11011001 - ---- --- ... 00000 ? x87
fincstp           11110111 11011001 - ---- --- ... 00000 ? x87
fyl2xp1           11111001 11011001 - ---- --- ... 00000 ? x87
fnstcw            0.111... 11011001 - ---- --- ... 00000 @m_r rw=2 msz=16 ? x87
fnstcw            10111... 11011001 - ---- --- ... 00000 @m_r rw=2 msz=16 ? x87
fprem             11111000 11011001 - ---- --- ... 00000 ? x87
fsqrt             11111010 11011001 - ---- --- ... 00000 ? x87
fsincos           11111011 11011001 - ---- --- ... 00000 ? x87
frndint           11111100 11011001 - ---- --- ... 00000 ? x87
fscale            11111101 11011001 - ---- --- ... 00000 ? x87
fsin              11111110 11011001 - ---- --- ... 00000 ? x87
fcos              11111111 11011001 - ---- --- ... 00000 ? x87
{
  fld             11000... 11011001 - ---- --- ... 00000 @si_r ? x87
  fld             ..000... 11011001 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=1 ? x87
}
{
  fnop            11010000 11011001 - ---- --- ... 00000 ? x87
  fst             ..010... 11011001 - ---- --- ... 00000 @m_r rw=2 msz=32 fp_suffix=1 ? x87
}
fstp              0.011... 11011001 - ---- --- ... 00000 @m_r rw=2 msz=32 fp_suffix=1 ? x87
fstp              10011... 11011001 - ---- --- ... 00000 @m_r rw=2 msz=32 fp_suffix=1 ? x87
{
  fld1            11101000 11011001 - ---- --- ... 00000 ? x87
  fldl2t          11101001 11011001 - ---- --- ... 00000 ? x87
  fldl2e          11101010 11011001 - ---- --- ... 00000 ? x87
  fldpi           11101011 11011001 - ---- --- ... 00000 ? x87
  fldlg2          11101100 11011001 - ---- --- ... 00000 ? x87
  fldln2          11101101 11011001 - ---- --- ... 00000 ? x87
  fldz            11101110 11011001 - ---- --- ... 00000 ? x87
  fldcw           ..101... 11011001 - ---- --- ... 00000 @m_r rw=1 msz=16 ? x87
}
fwait                      10011011 - ---- --- ... 00000 ? x87
{
  fcmovb          11000... 11011010 - ---- --- ... 00000 @st_m @si_r ? x87
  fiadd           ..000... 11011010 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=64 ? x87
}
{
  fcmove          11001... 11011010 - ---- --- ... 00000 @st_m @si_r ? x87
  fimul           ..001... 11011010 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=64 ? x87
}
{
  fcmovbe         11010... 11011010 - ---- --- ... 00000 @st_m @si_r ? x87
  ficom           ..010... 11011010 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=64 ? x87
}
{
  fcmovu          11011... 11011010 - ---- --- ... 00000 @st_m @si_r ? x87
  ficomp          ..011... 11011010 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=64 ? x87
}
fisub             0.100... 11011010 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=64 ? x87
fisub             10100... 11011010 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=64 ? x87
fucompp           11101001 11011010 - ---- --- ... 00000 ? x87
fisubr            0.101... 11011010 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=64 ? x87
fisubr            10101... 11011010 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=64 ? x87
fidiv             0.110... 11011010 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=64 ? x87
fidiv             10110... 11011010 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=64 ? x87
fidivr            0.111... 11011010 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=64 ? x87
fidivr            10111... 11011010 - ---- --- ... 00000 @m_r rw=1 msz=32 fp_suffix=64 ? x87
{
  fcmovnb         11000... 11011011 - ---- --- ... 00000 @st_m @si_r ? x87
  fildl           ..000... 11011011 - ---- --- ... 00000 @m_r rw=1 msz=32 ? x87 att
  fild            ..000... 11011011 - ---- --- ... 00000 @m_r rw=1 msz=32 ? x87
}
{
  fcmovne         11001... 11011011 - ---- --- ... 00000 @st_m @si_r ? x87
  fisttp          ..001... 11011011 - ---- --- ... 00000 @m_r rw=2 msz=32 fp_suffix=64 ? x87
}
{
  fcmovnbe        11010... 11011011 - ---- --- ... 00000 @st_m @si_r ? x87
  fist            ..010... 11011011 - ---- --- ... 00000 @m_r rw=2 msz=32 fp_suffix=64 ? x87
}
{
  fcmovnu         11011... 11011011 - ---- --- ... 00000 @st_m @si_r ? x87
  fistp           ..011... 11011011 - ---- --- ... 00000 @m_r rw=2 msz=32 fp_suffix=64 ? x87
}
fnclex            11100010 11011011 - ---- --- ... 00000 ? x87
fninit            11100011 11011011 - ---- --- ... 00000 ? x87
{
  fucomi          11101... 11011011 - ---- --- ... 00000 @st_m @si_r ? x87
  fldt            ..101... 11011011 - ---- --- ... 00000 @m_r rw=1 ? x87 att
  fld             ..101... 11011011 - ---- --- ... 00000 @m_r rw=1 msz=-1 ? x87
}
fcomi             11110... 11011011 - ---- --- ... 00000 @st_m @si_r ? x87
{
  fstpt           ..111... 11011011 - ---- --- ... 00000 @m_r rw=2 ? x87 att
  fstp            ..111... 11011011 - ---- --- ... 00000 @m_r rw=2 msz=-1 ? x87
}
{
  fadd            11000... 11011100 - ---- --- ... 00000 @si_r @st_m ? x87
  fadd            ..000... 11011100 - ---- --- ... 00000 @m_r rw=1 msz=64 fp_suffix=1 ? x87
}
{
  fmul            11001... 11011100 - ---- --- ... 00000 @si_r @st_m ? x87
  fmul            ..001... 11011100 - ---- --- ... 00000 @m_r rw=1 msz=64 fp_suffix=1 ? x87
}
{
  fsub            11100... 11011100 - ---- --- ... 00000 @si_r @st_m ? x87 att
  fsubr           11100... 11011100 - ---- --- ... 00000 @si_r @st_m ? x87
  fsub            ..100... 11011100 - ---- --- ... 00000 @m_r rw=1 msz=64 fp_suffix=1 ? x87
}
{
  fsubr           11101... 11011100 - ---- --- ... 00000 @si_r @st_m ? x87 att
  fsub            11101... 11011100 - ---- --- ... 00000 @si_r @st_m ? x87
  fsubr           ..101... 11011100 - ---- --- ... 00000 @m_r rw=1 msz=64 fp_suffix=1 ? x87
}
{
  fdiv            11110... 11011100 - ---- --- ... 00000 @si_r @st_m ? x87 att
  fdivr           11110... 11011100 - ---- --- ... 00000 @si_r @st_m ? x87
  fdiv            ..110... 11011100 - ---- --- ... 00000 @m_r rw=1 msz=64 fp_suffix=1 ? x87
}
{
  fdivr           11111... 11011100 - ---- --- ... 00000 @si_r @st_m ? x87 att
  fdiv            11111... 11011100 - ---- --- ... 00000 @si_r @st_m ? x87
  fdivr           ..111... 11011100 - ---- --- ... 00000 @m_r rw=1 msz=64 fp_suffix=1 ? x87
}
{
  ffree           11000... 11011101 - ---- --- ... 00000 @si_r ? x87
  fldl            ..000... 11011101 - ---- --- ... 00000 @m_r rw=1 msz=64 ? x87 att
  fld             ..000... 11011101 - ---- --- ... 00000 @m_r rw=1 msz=64 ? x87
}
fisttp            0.001... 11011101 - ---- --- ... 00000 @m_r rw=2 msz=64 fp_suffix=80 ? x87
fisttp            10001... 11011101 - ---- --- ... 00000 @m_r rw=2 msz=64 fp_suffix=80 ? x87
{
  fst             11010... 11011101 - ---- --- ... 00000 @si_w ? x87
  fst             ..010... 11011101 - ---- --- ... 00000 @m_r rw=2 msz=64 fp_suffix=1 ? x87
}
{
  fstp            11011... 11011101 - ---- --- ... 00000 @si_w ? x87
  fstpl           ..011... 11011101 - ---- --- ... 00000 @m_r rw=2 msz=64 ? x87 att
  fstp            ..011... 11011101 - ---- --- ... 00000 @m_r rw=2 msz=64 ? x87
}
{
  fucom           11100... 11011101 - ---- --- ... 00000 @si_r ? x87
  frstor          ..100... 11011101 - ---- --- ... 00000 no_ptr=1 @m_r rw=1 msz=8 ? x87
}
fucomp            11101... 11011101 - ---- --- ... 00000 @si_r ? x87
fnsave            0.110... 11011101 - ---- --- ... 00000 no_ptr=1 @m_r rw=2 msz=8 ? x87
fnsave            10110... 11011101 - ---- --- ... 00000 no_ptr=1 @m_r rw=2 msz=8 ? x87
{
# fstsw           ..111... 11011101 - ---- --- ... 00000 @m_r rw=2 ? x87
  fnstsw          ..111... 11011101 - ---- --- ... 00000 @m_r rw=2 msz=16 ? x87
}
{
  faddp           11000... 11011110 - ---- --- ... 00000 @si_r @st_m ? x87
  fiadd           ..000... 11011110 - ---- --- ... 00000 @m_r rw=1 msz=16 fp_suffix=32 ? x87
}
{
  fmulp           11001... 11011110 - ---- --- ... 00000 @si_r @st_m ? x87
  fimul           ..001... 11011110 - ---- --- ... 00000 @m_r rw=1 msz=16 fp_suffix=32 ? x87
}
ficom             0.010... 11011110 - ---- --- ... 00000 @m_r rw=1 msz=16 fp_suffix=32 ? x87
ficom             10010... 11011110 - ---- --- ... 00000 @m_r rw=1 msz=16 fp_suffix=32 ? x87
{
  fsubp           11100... 11011110 - ---- --- ... 00000 @si_r @st_m ? x87 att
  fsubrp          11100... 11011110 - ---- --- ... 00000 @si_r @st_m ? x87
  fisub           ..100... 11011110 - ---- --- ... 00000 @m_r rw=1 msz=16 fp_suffix=32 ? x87
}
{
  fsubrp          11101... 11011110 - ---- --- ... 00000 @si_r @st_m ? x87 att
  fsubp           11101... 11011110 - ---- --- ... 00000 @si_r @st_m ? x87
  fisubr          ..101... 11011110 - ---- --- ... 00000 @m_r rw=1 msz=16 fp_suffix=32 ? x87
}
{
  fdivp           11110... 11011110 - ---- --- ... 00000 @si_r @st_m ? x87 att
  fdivrp          11110... 11011110 - ---- --- ... 00000 @si_r @st_m ? x87
  fidiv           ..110... 11011110 - ---- --- ... 00000 @m_r rw=1 msz=16 fp_suffix=32 ? x87
}
{
  fdivrp          11111... 11011110 - ---- --- ... 00000 @si_m @st_m ? x87 att
  fdivp           11111... 11011110 - ---- --- ... 00000 @si_m @st_m ? x87
  fidivr          ..111... 11011110 - ---- --- ... 00000 @m_r rw=1 msz=16 fp_suffix=32 ? x87
}
{
  ffreep          11000... 11011111 - ---- --- ... 00000 @si_r ? x87
  filds           ..000... 11011111 - ---- --- ... 00000 @m_r rw=1 msz=16 ? x87 att
  fild            ..000... 11011111 - ---- --- ... 00000 @m_r rw=1 msz=16 ? x87
}
fisttp            0.001... 11011111 - ---- --- ... 00000 @m_r rw=2 msz=16 fp_suffix=32 ? x87
fisttp            10001... 11011111 - ---- --- ... 00000 @m_r rw=2 msz=16 fp_suffix=32 ? x87
fist              0.010... 11011111 - ---- --- ... 00000 @m_r rw=2 msz=16 fp_suffix=32 ? x87
fist              10010... 11011111 - ---- --- ... 00000 @m_r rw=2 msz=16 fp_suffix=32 ? x87
fistp             0.011... 11011111 - ---- --- ... 00000 @m_r rw=2 msz=16 fp_suffix=32 ? x87
fistp             10011... 11011111 - ---- --- ... 00000 @m_r rw=2 msz=16 fp_suffix=32 ? x87
{
# fstsw           11100000 11011111 - ---- --- ... 00000 @r_r rw=2 reg=0 rsz=16 ? x87
  fnstsw          11100000 11011111 - ---- --- ... 00000 @m_r rw=2 b=0 msz=16 ? x87
  fbld            ..100... 11011111 - ---- --- ... 00000 @m_r rw=1 msz=-1 ? x87
}
{
  fucomip         11101... 11011111 - ---- --- ... 00000 @st_m @si_m ? x87
  fildll          ..101... 11011111 - ---- --- ... 00000 @m_r rw=1 msz=64 ? x87 att
  fild            ..101... 11011111 - ---- --- ... 00000 @m_r rw=1 msz=64 ? x87
}
{
  fcomip          11110... 11011111 - ---- --- ... 00000 @st_m @si_m ? x87
  fbstp           ..110... 11011111 - ---- --- ... 00000 @m_r rw=2 msz=-1 ? x87
}
fistp             ..111... 11011111 - ---- --- ... 00000 @m_r rw=2 msz=64 fp_suffix=80 ? x87

##############################################################################
# Extension MMX
##############################################################################

punpcklbw         ........ 01100000 - ---- -00 ... 00001 @rm_mm msz=32 ? mmx
punpcklwd         ........ 01100001 - ---- -00 ... 00001 @rm_mm msz=32 ? mmx
punpckldq         ........ 01100010 - ---- -00 ... 00001 @rm_mm msz=32 ? mmx
packsswb          ........ 01100011 - ---- -00 ... 00001 @rm_mm ? mmx
pcmpgtb           ........ 01100100 - ---- -00 ... 00001 @rm_mm ? mmx
pcmpgtw           ........ 01100101 - ---- -00 ... 00001 @rm_mm ? mmx
pcmpgtd           ........ 01100110 - ---- -00 ... 00001 @rm_mm ? mmx
packuswb          ........ 01100111 - ---- -00 ... 00001 @rm_mm ? mmx
punpckhbw         ........ 01101000 - ---- -00 ... 00001 @rm_mm ? mmx
punpckhwd         ........ 01101001 - ---- -00 ... 00001 @rm_mm ? mmx
punpckhdq         ........ 01101010 - ---- -00 ... 00001 @rm_mm ? mmx
packssdw          ........ 01101011 - ---- -00 ... 00001 @rm_mm ? mmx
movd              ........ 01101110 0 ---- -00 ... 00001 @r_m rw=2 @m_r rw=1 ? mmx
movq              ........ 01101110 1 ---- -00 ... 00001 @r_m rw=2 @m_r rw=1 ? mmx
movq              ........ 01101111 - ---- -00 ... 00001 @rm_mm rw=2 ? mmx
pshufw            ........ 01110000 - ---- -00 ... 00001 @rm_mm rw=2 uimm=8 ? mmx
psllw             ..110... 01110001 - ---- -00 ... 00001 @m_m uimm=8 ? mmx
psraw             ..100... 01110001 - ---- -00 ... 00001 @m_m uimm=8 ? mmx
psrlw             ..010... 01110001 - ---- -00 ... 00001 @m_m uimm=8 ? mmx
pslld             ..110... 01110010 - ---- -00 ... 00001 @m_m uimm=8 ? mmx
psrad             ..100... 01110010 - ---- -00 ... 00001 @m_m uimm=8 ? mmx
psrld             ..010... 01110010 - ---- -00 ... 00001 @m_m uimm=8 ? mmx
psllq             ..110... 01110011 - ---- -00 ... 00001 @m_m uimm=8 ? mmx
psrlq             ..010... 01110011 - ---- -00 ... 00001 @m_m uimm=8 ? mmx
pcmpeqb           ........ 01110100 - ---- -00 ... 00001 @rm_mm ? mmx
pcmpeqw           ........ 01110101 - ---- -00 ... 00001 @rm_mm ? mmx
pcmpeqd           ........ 01110110 - ---- -00 ... 00001 @rm_mm ? mmx
movd              ........ 01111110 0 ---- -00 ... 00001 @mr_rm rw=2 ? mmx
movq              ........ 01111110 1 ---- -00 ... 00001 @mr_rm rw=2 ? mmx
movq              ........ 01111111 - ---- -00 ... 00001 @mr_mm rw=2 ? mmx
psrlw             ........ 11010001 - ---- -00 ... 00001 @rm_mm ? mmx
psrld             ........ 11010010 - ---- -00 ... 00001 @rm_mm ? mmx
psrlq             ........ 11010011 - ---- -00 ... 00001 @rm_mm ? mmx
paddq             ........ 11010100 - ---- -00 ... 00001 @rm_mm ? mmx
pmullw            ........ 11010101 - ---- -00 ... 00001 @rm_mm ? mmx
psubusb           ........ 11011000 - ---- -00 ... 00001 @rm_mm ? mmx
psubusw           ........ 11011001 - ---- -00 ... 00001 @rm_mm ? mmx
pminub            ........ 11011010 - ---- -00 ... 00001 @rm_mm ? mmx
pand              ........ 11011011 - ---- -00 ... 00001 @rm_mm ? mmx
paddusb           ........ 11011100 - ---- -00 ... 00001 @rm_mm ? mmx
paddusw           ........ 11011101 - ---- -00 ... 00001 @rm_mm ? mmx
pandn             ........ 11011111 - ---- -00 ... 00001 @rm_mm ? mmx
psraw             ........ 11100001 - ---- -00 ... 00001 @rm_mm ? mmx
psrad             ........ 11100010 - ---- -00 ... 00001 @rm_mm ? mmx
movntq            ........ 11100111 - ---- -00 ... 00001 @mr_mm rw=2 ? mmx
psubsb            ........ 11101000 - ---- -00 ... 00001 @rm_mm ? mmx
psubsw            ........ 11101001 - ---- -00 ... 00001 @rm_mm ? mmx
por               ........ 11101011 - ---- -00 ... 00001 @rm_mm ? mmx
paddsb            ........ 11101100 - ---- -00 ... 00001 @rm_mm ? mmx
paddsw            ........ 11101101 - ---- -00 ... 00001 @rm_mm ? mmx
pxor              ........ 11101111 - ---- -00 ... 00001 @rm_mm ? mmx
psllw             ........ 11110001 - ---- -00 ... 00001 @rm_mm ? mmx
pslld             ........ 11110010 - ---- -00 ... 00001 @rm_mm ? mmx
psllq             ........ 11110011 - ---- -00 ... 00001 @rm_mm ? mmx
pmuludq           ........ 11110100 - ---- -00 ... 00001 @rm_mm ? mmx
pmaddwd           ........ 11110101 - ---- -00 ... 00001 @rm_mm ? mmx
maskmovq          ........ 11110111 - ---- -00 ... 00001 @rm_mm rw=1 ? mmx
psubb             ........ 11111000 - ---- -00 ... 00001 @rm_mm ? mmx
psubw             ........ 11111001 - ---- -00 ... 00001 @rm_mm ? mmx
psubd             ........ 11111010 - ---- -00 ... 00001 @rm_mm ? mmx
psubq             ........ 11111011 - ---- -00 ... 00001 @rm_mm ? mmx
paddb             ........ 11111100 - ---- -00 ... 00001 @rm_mm ? mmx
paddw             ........ 11111101 - ---- -00 ... 00001 @rm_mm ? mmx
paddd             ........ 11111110 - ---- -00 ... 00001 @rm_mm ? mmx

##############################################################################
# Extension SSE
##############################################################################

{
  sfence          11111000 10101110 - ---- -00 ... 00001 ? sse
  clflush         ..111... 10101110 - ---- -00 ... 00001 @m_r rw=2 msz=8
}

movups            ........ 00010000 - ---- -00 ... 00001 @rm_xx rw=2 ? sse
movups            ........ 00010001 - ---- -00 ... 00001 @mr_xx rw=2 ? sse
movlps            0....... 00010010 - ---- -00 ... 00001 @rm_xx msz=64 ? sse
movlps            10...... 00010010 - ---- -00 ... 00001 @rm_xx msz=64 ? sse
movhlps           11...... 00010010 - ---- -00 ... 00001 @rm_xx rw=2 ? sse
movlps            0....... 00010011 - ---- -00 ... 00001 @mr_xx rw=2 msz=64 ? sse
movlps            10...... 00010011 - ---- -00 ... 00001 @mr_xx rw=2 msz=64 ? sse
unpcklps          ........ 00010100 - ---- -00 ... 00001 @rm_xx ? sse
unpckhps          ........ 00010101 - ---- -00 ... 00001 @rm_xx ? sse
movlhps           11...... 00010110 - ---- -00 ... 00001 @rm_xx rw=2 ? sse
movaps            ........ 00101000 - ---- -00 ... 00001 @rm_xx rw=2 ? sse
movaps            ........ 00101001 - ---- -00 ... 00001 @mr_xx rw=2 ? sse
movntps           0....... 00101011 - ---- -00 ... 00001 @mr_xx rw=2 ? sse
movntps           10...... 00101011 - ---- -00 ... 00001 @mr_xx rw=2 ? sse
cvttps2pi         ........ 00101100 - ---- -00 ... 00001 @rm_mx rw=2 msz=64 ? sse
cvtps2pi          ........ 00101101 - ---- -00 ... 00001 @rm_mx rw=2 msz=64 ? sse
ucomiss           ........ 00101110 - ---- -00 ... 00001 @rm_xx rw=1 msz=32 ? sse
comiss            ........ 00101111 - ---- -00 ... 00001 @rm_xx rw=1 msz=32 ? sse
movmskps          11...... 01010000 - ---- -00 ... 00001 @rm_rx rw=2 rsz=32 ? sse
sqrtps            ........ 01010001 - ---- -00 ... 00001 @rm_xx rw=2 ? sse
rsqrtps           ........ 01010010 - ---- -00 ... 00001 @rm_xx rw=2 ? sse
rcpps             ........ 01010011 - ---- -00 ... 00001 @rm_xx rw=2 ? sse
andps             ........ 01010100 - ---- -00 ... 00001 @rm_xx ? sse
andnps            ........ 01010101 - ---- -00 ... 00001 @rm_xx ? sse
orps              ........ 01010110 - ---- -00 ... 00001 @rm_xx ? sse
xorps             ........ 01010111 - ---- -00 ... 00001 @rm_xx ? sse
addps             ........ 01011000 - ---- -00 ... 00001 @rm_xx ? sse
mulps             ........ 01011001 - ---- -00 ... 00001 @rm_xx ? sse
subps             ........ 01011100 - ---- -00 ... 00001 @rm_xx ? sse
divps             ........ 01011110 - ---- -00 ... 00001 @rm_xx ? sse
ldmxcsr           0.010... 10101110 - ---- -00 ... 00001 @m_r rw=1 msz=32 ? sse
ldmxcsr           10010... 10101110 - ---- -00 ... 00001 @m_r rw=1 msz=32 ? sse
stmxcsr           0.011... 10101110 - ---- -00 ... 00001 @m_r rw=2 msz=32 ? sse
stmxcsr           10011... 10101110 - ---- -00 ... 00001 @m_r rw=2 msz=32 ? sse
pinsrw            ........ 11000100 - ---- -00 ... 00001 @rm_mr rw=2 uimm=8 msz=16 bsz=32 ? sse
pextrw            11...... 11000101 - ---- -00 ... 00001 @rm_rm rw=2 uimm=8 rsz=32 ? sse
shufps            ........ 11000110 - ---- -00 ... 00001 @rm_xx uimm=8 ? sse
pmovmskb          11...... 11010111 - ---- -00 ... 00001 @rm_rm rw=2 rsz=32 msz=32 ? sse
pmaxub            ........ 11011110 - ---- -00 ... 00001 @rm_mm ? sse
pavgb             ........ 11100000 - ---- -00 ... 00001 @rm_mm ? sse
pavgw             ........ 11100011 - ---- -00 ... 00001 @rm_mm ? sse
pmulhuw           ........ 11100100 - ---- -00 ... 00001 @rm_mm ? sse
pmulhw            ........ 11100101 - ---- -00 ... 00001 @rm_mm ? sse
pminsw            ........ 11101010 - ---- -00 ... 00001 @rm_mm ? sse
pmaxsw            ........ 11101110 - ---- -00 ... 00001 @rm_mm ? sse
psadbw            ........ 11110110 - ---- -00 ... 00001 @rm_mm ? sse

clflushopt        ..111... 10101110 - ---- -01 ... 00001 @m_r rw=2 msz=8

movss             ........ 00010000 - ---- -10 ... 00001 @rm_xx rw=2 msz=32 ? sse
movss             ........ 00010001 - ---- -10 ... 00001 @mr_xx rw=2 msz=32 ? sse
cvttss2si         ........ 00101100 - ---- -10 ... 00001 @rm_rx rw=2 msz=32 ? sse
cvtss2si          ........ 00101101 - ---- -10 ... 00001 @rm_rx rw=2 msz=32 ? sse
sqrtss            ........ 01010001 - ---- -10 ... 00001 @rm_xx rw=2 msz=32 ? sse
rsqrtss           ........ 01010010 - ---- -10 ... 00001 @rm_xx rw=2 msz=32 ? sse
rcpss             ........ 01010011 - ---- -10 ... 00001 @rm_xx rw=2 msz=32 ? sse
addss             ........ 01011000 - ---- -10 ... 00001 @rm_xx msz=32 ? sse
mulss             ........ 01011001 - ---- -10 ... 00001 @rm_xx msz=32 ? sse
subss             ........ 01011100 - ---- -10 ... 00001 @rm_xx msz=32 ? sse
divss             ........ 01011110 - ---- -10 ... 00001 @rm_xx msz=32 ? sse

movdq2q           11...... 11010110 - ---- -11 ... 00001 @rm_mx rw=2 ? sse

cmpps             ........ 11000010 - ---- 000 ... 00001 @rm_xx opc=8 ? sse
cmpeqps           00000000 11000010 - ---- 100 ... 00001 ? never
cmpltps           00000001 11000010 - ---- 100 ... 00001 ? never
cmpleps           00000010 11000010 - ---- 100 ... 00001 ? never
cmpunordps        00000011 11000010 - ---- 100 ... 00001 ? never
cmpneqps          00000100 11000010 - ---- 100 ... 00001 ? never
cmpnltps          00000101 11000010 - ---- 100 ... 00001 ? never
cmpnleps          00000110 11000010 - ---- 100 ... 00001 ? never
cmpordps          00000111 11000010 - ---- 100 ... 00001 ? never
cmpss             ........ 11000010 - ---- 010 ... 00001 @rm_xx msz=32 opc=8 ? sse
cmpeqss           00000000 11000010 - ---- 110 ... 00001 ? never
cmpltss           00000001 11000010 - ---- 110 ... 00001 ? never
cmpless           00000010 11000010 - ---- 110 ... 00001 ? never
cmpunordss        00000011 11000010 - ---- 110 ... 00001 ? never
cmpneqss          00000100 11000010 - ---- 110 ... 00001 ? never
cmpnltss          00000101 11000010 - ---- 110 ... 00001 ? never
cmpnless          00000110 11000010 - ---- 110 ... 00001 ? never
cmpordss          00000111 11000010 - ---- 110 ... 00001 ? never

##############################################################################
# Extension SSE2
##############################################################################

pinsrw            ........ 11000100 - ---- -01 ... 00001 @rm_xr rw=2 uimm=8 msz=16 bsz=32 ? sse2

mfence            11110000 10101110 - 000- --- ... 00001 ? sse2
lfence            11101000 10101110 0 000- --- ... 00001 ? sse2

movhps            0....... 00010110 - ---- -00 ... 00001 @rm_xx rw=2 msz=64 ? sse2
movhps            10...... 00010110 - ---- -00 ... 00001 @rm_xx rw=2 msz=64 ? sse2
movhps            0....... 00010111 - ---- -00 ... 00001 @mr_xx rw=2 msz=64 ? sse2
movhps            10...... 00010111 - ---- -00 ... 00001 @mr_xx rw=2 msz=64 ? sse2
cvtpi2ps          ........ 00101010 - ---- -00 ... 00001 @rm_xm rw=2 ? sse2
cvtps2pd          ........ 01011010 - ---- -00 ... 00001 @rm_xx rw=2 msz=64 ? sse2
cvtdq2ps          ........ 01011011 - ---- -00 ... 00001 @rm_xx rw=2 ? sse2
minps             ........ 01011101 - ---- -00 ... 00001 @rm_xx ? sse2
maxps             ........ 01011111 - ---- -00 ... 00001 @rm_xx ? sse2
movnti            ........ 11000011 - ---- -00 ... 00001 @mr_rr ? sse2

movupd            ........ 00010000 - ---- -01 ... 00001 @rm_xx rw=2 ? sse2
movupd            ........ 00010001 - ---- -01 ... 00001 @mr_xx rw=2 ? sse2
movlpd            0....... 00010010 - ---- -01 ... 00001 @rm_xx msz=64 ? sse2
movlpd            10...... 00010010 - ---- -01 ... 00001 @rm_xx msz=64 ? sse2
movlpd            0....... 00010011 - ---- -01 ... 00001 @mr_xx rw=2 msz=64 ? sse2
movlpd            10...... 00010011 - ---- -01 ... 00001 @mr_xx rw=2 msz=64 ? sse2
unpcklpd          ........ 00010100 - ---- -01 ... 00001 @rm_xx ? sse2
unpckhpd          ........ 00010101 - ---- -01 ... 00001 @rm_xx ? sse2
movhpd            0....... 00010110 - ---- -01 ... 00001 @rm_xx rw=2 msz=64 ? sse2
movhpd            10...... 00010110 - ---- -01 ... 00001 @rm_xx rw=2 msz=64 ? sse2
movhpd            0....... 00010111 - ---- -01 ... 00001 @mr_xx rw=2 msz=64 ? sse2
movhpd            10...... 00010111 - ---- -01 ... 00001 @mr_xx rw=2 msz=64 ? sse2
movapd            ........ 00101000 - ---- -01 ... 00001 @rm_xx rw=2 ? sse2
movapd            ........ 00101001 - ---- -01 ... 00001 @mr_xx rw=2 ? sse2
cvtpi2pd          ........ 00101010 - ---- -01 ... 00001 @rm_xm rw=2 ? sse2
movntpd           0....... 00101011 - ---- -01 ... 00001 @mr_xx rw=2 ? sse2
movntpd           11...... 00101011 - ---- -01 ... 00001 @mr_xx rw=2 ? sse2
cvttpd2pi         ........ 00101100 - ---- -01 ... 00001 @rm_mx rw=2 ? sse2
cvtpd2pi          ........ 00101101 - ---- -01 ... 00001 @rm_mx rw=2 ? sse2
ucomisd           ........ 00101110 - ---- -01 ... 00001 @rm_xx rw=1 msz=64 ? sse2
comisd            ........ 00101111 - ---- -01 ... 00001 @rm_xx rw=2 msz=64 ? sse2
movmskpd          11...... 01010000 - ---- -01 ... 00001 @rm_rx rw=2 rsz=32 ? sse2
sqrtpd            ........ 01010001 - ---- -01 ... 00001 @rm_xx rw=2 ? sse2
andpd             ........ 01010100 - ---- -01 ... 00001 @rm_xx ? sse2
andnpd            ........ 01010101 - ---- -01 ... 00001 @rm_xx ? sse2
orpd              ........ 01010110 - ---- -01 ... 00001 @rm_xx ? sse2
xorpd             ........ 01010111 - ---- -01 ... 00001 @rm_xx ? sse2
addpd             ........ 01011000 - ---- -01 ... 00001 @rm_xx ? sse2
mulpd             ........ 01011001 - ---- -01 ... 00001 @rm_xx ? sse2
cvtpd2ps          ........ 01011010 - ---- -01 ... 00001 @rm_xx rw=2 ? sse2
cvtps2dq          ........ 01011011 - ---- -01 ... 00001 @rm_xx rw=2 ? sse2
subpd             ........ 01011100 - ---- -01 ... 00001 @rm_xx ? sse2
minpd             ........ 01011101 - ---- -01 ... 00001 @rm_xx ? sse2
divpd             ........ 01011110 - ---- -01 ... 00001 @rm_xx ? sse2
maxpd             ........ 01011111 - ---- -01 ... 00001 @rm_xx ? sse2
punpcklbw         ........ 01100000 - ---- -01 ... 00001 @rm_xx ? sse2
punpcklwd         ........ 01100001 - ---- -01 ... 00001 @rm_xx ? sse2
punpckldq         ........ 01100010 - ---- -01 ... 00001 @rm_xx ? sse2
packsswb          ........ 01100011 - ---- -01 ... 00001 @rm_xx ? sse2
pcmpgtb           ........ 01100100 - ---- -01 ... 00001 @rm_xx ? sse2
pcmpgtw           ........ 01100101 - ---- -01 ... 00001 @rm_xx ? sse2
pcmpgtd           ........ 01100110 - ---- -01 ... 00001 @rm_xx ? sse2
packuswb          ........ 01100111 - ---- -01 ... 00001 @rm_xx ? sse2
punpckhbw         ........ 01101000 - ---- -01 ... 00001 @rm_xx ? sse2
punpckhwd         ........ 01101001 - ---- -01 ... 00001 @rm_xx ? sse2
punpckhdq         ........ 01101010 - ---- -01 ... 00001 @rm_xx ? sse2
packssdw          ........ 01101011 - ---- -01 ... 00001 @rm_xx ? sse2
punpcklqdq        ........ 01101100 - ---- -01 ... 00001 @rm_xx ? sse2
punpckhqdq        ........ 01101101 - ---- -01 ... 00001 @rm_xx ? sse2
movd              ........ 01101110 0 ---- -01 ... 00001 @rm_xr rw=2 msz=32 ? sse2
movq              ........ 01101110 1 ---- -01 ... 00001 @rm_xr rw=2 msz=64 ? sse2
movdqa            ........ 01101111 - ---- -01 ... 00001 @rm_xx rw=2 ? sse2
pshufd            ........ 01110000 - ---- -01 ... 00001 @rm_xx rw=2 uimm=8 ? sse2
psllw             ..110... 01110001 - ---- -01 ... 00001 @m_x uimm=8 ? sse2
psraw             ..100... 01110001 - ---- -01 ... 00001 @m_x uimm=8 ? sse2
psrlw             ..010... 01110001 - ---- -01 ... 00001 @m_x uimm=8 ? sse2
pslld             ..110... 01110010 - ---- -01 ... 00001 @m_x uimm=8 ? sse2
psrad             ..100... 01110010 - ---- -01 ... 00001 @m_x uimm=8 ? sse2
psrld             ..010... 01110010 - ---- -01 ... 00001 @m_x uimm=8 ? sse2
psllq             ..110... 01110011 - ---- -01 ... 00001 @m_x uimm=8 ? sse2
psrldq            11011... 01110011 - ---- -01 ... 00001 @m_x uimm=8 ? sse2
pslldq            11111... 01110011 - ---- -01 ... 00001 @m_x uimm=8 ? sse2
psrlq             ..010... 01110011 - ---- -01 ... 00001 @m_x uimm=8 ? sse2
pcmpeqb           ........ 01110100 - ---- -01 ... 00001 @rm_xx ? sse2
pcmpeqw           ........ 01110101 - ---- -01 ... 00001 @rm_xx ? sse2
pcmpeqd           ........ 01110110 - ---- -01 ... 00001 @rm_xx ? sse2
movd              ........ 01111110 0 ---- -01 ... 00001 @mr_rx rw=2 msz=32 ? sse2
movq              ........ 01111110 1 ---- -01 ... 00001 @mr_rx rw=2 msz=64 ? sse2
movdqa            ........ 01111111 - ---- -01 ... 00001 @mr_xx rw=2 ? sse2
pextrw            11...... 11000101 - ---- -01 ... 00001 @rm_rx rw=2 uimm=8 rsz=32 ? sse2
shufpd            ........ 11000110 - ---- -01 ... 00001 @rm_xx uimm=8 ? sse2
psrlw             ........ 11010001 - ---- -01 ... 00001 @rm_xx ? sse2
psrld             ........ 11010010 - ---- -01 ... 00001 @rm_xx ? sse2
psrlq             ........ 11010011 - ---- -01 ... 00001 @rm_xx ? sse2
paddq             ........ 11010100 - ---- -01 ... 00001 @rm_xx ? sse2
pmullw            ........ 11010101 - ---- -01 ... 00001 @rm_xx ? sse2
movq              ........ 11010110 - ---- -01 ... 00001 @mr_xx rw=2 msz=64 ? sse2
pmovmskb          11...... 11010111 - ---- -01 ... 00001 @rm_rx rw=2 msz=32 rsz=32 ? sse2
psubusb           ........ 11011000 - ---- -01 ... 00001 @rm_xx ? sse2
psubusw           ........ 11011001 - ---- -01 ... 00001 @rm_xx ? sse2
pminub            ........ 11011010 - ---- -01 ... 00001 @rm_xx ? sse2
pand              ........ 11011011 - ---- -01 ... 00001 @rm_xx ? sse2
paddusb           ........ 11011100 - ---- -01 ... 00001 @rm_xx ? sse2
paddusw           ........ 11011101 - ---- -01 ... 00001 @rm_xx ? sse2
pmaxub            ........ 11011110 - ---- -01 ... 00001 @rm_xx ? sse2
pandn             ........ 11011111 - ---- -01 ... 00001 @rm_xx ? sse2
pavgb             ........ 11100000 - ---- -01 ... 00001 @rm_xx ? sse2
psraw             ........ 11100001 - ---- -01 ... 00001 @rm_xx ? sse2
psrad             ........ 11100010 - ---- -01 ... 00001 @rm_xx ? sse2
pavgw             ........ 11100011 - ---- -01 ... 00001 @rm_xx ? sse2
pmulhuw           ........ 11100100 - ---- -01 ... 00001 @rm_xx ? sse2
pmulhw            ........ 11100101 - ---- -01 ... 00001 @rm_xx ? sse2
cvttpd2dq         ........ 11100110 - ---- -01 ... 00001 @rm_xx rw=2 ? sse2
movntdq           0....... 11100111 - ---- -01 ... 00001 @mr_xx rw=2 ? sse2
movntdq           10...... 11100111 - ---- -01 ... 00001 @mr_xx rw=2 ? sse2
psubsb            ........ 11101000 - ---- -01 ... 00001 @rm_xx ? sse2
psubsw            ........ 11101001 - ---- -01 ... 00001 @rm_xx ? sse2
pminsw            ........ 11101010 - ---- -01 ... 00001 @rm_xx ? sse2
por               ........ 11101011 - ---- -01 ... 00001 @rm_xx ? sse2
paddsb            ........ 11101100 - ---- -01 ... 00001 @rm_xx ? sse2
paddsw            ........ 11101101 - ---- -01 ... 00001 @rm_xx ? sse2
pmaxsw            ........ 11101110 - ---- -01 ... 00001 @rm_xx ? sse2
pxor              ........ 11101111 - ---- -01 ... 00001 @rm_xx ? sse2
psllw             ........ 11110001 - ---- -01 ... 00001 @rm_xx ? sse2
pslld             ........ 11110010 - ---- -01 ... 00001 @rm_xx ? sse2
psllq             ........ 11110011 - ---- -01 ... 00001 @rm_xx ? sse2
pmuludq           ........ 11110100 - ---- -01 ... 00001 @rm_xx ? sse2
pmaddwd           ........ 11110101 - ---- -01 ... 00001 @rm_xx ? sse2
psadbw            ........ 11110110 - ---- -01 ... 00001 @rm_xx ? sse2
maskmovdqu        11...... 11110111 - ---- -01 ... 00001 @rm_xx rw=1 ? sse2
psubb             ........ 11111000 - ---- -01 ... 00001 @rm_xx ? sse2
psubw             ........ 11111001 - ---- -01 ... 00001 @rm_xx ? sse2
psubd             ........ 11111010 - ---- -01 ... 00001 @rm_xx ? sse2
psubq             ........ 11111011 - ---- -01 ... 00001 @rm_xx ? sse2
paddb             ........ 11111100 - ---- -01 ... 00001 @rm_xx ? sse2
paddw             ........ 11111101 - ---- -01 ... 00001 @rm_xx ? sse2
paddd             ........ 11111110 - ---- -01 ... 00001 @rm_xx ? sse2

cvtsi2ss          ........ 00101010 - ---- -10 ... 00001 @rm_xr rw=2 msz=3 suffix=3 ? sse2
cvtss2sd          ........ 01011010 - ---- -10 ... 00001 @rm_xx rw=2 msz=32 ? sse2
cvttps2dq         ........ 01011011 - ---- -10 ... 00001 @rm_xx rw=2 ? sse2
minss             ........ 01011101 - ---- -10 ... 00001 @rm_xx msz=32 ? sse2
maxss             ........ 01011111 - ---- -10 ... 00001 @rm_xx msz=32 ? sse2
movdqu            ........ 01101111 - ---- -10 ... 00001 @rm_xx rw=2 ? sse2
pshufhw           ........ 01110000 - ---- -10 ... 00001 @rm_xx rw=2 uimm=8 ? sse2
movq              ........ 01111110 - ---- -10 ... 00001 @rm_xx rw=2 msz=64 ? sse2
movdqu            ........ 01111111 - ---- -10 ... 00001 @mr_xx rw=2 ? sse2
movq2dq           11...... 11010110 - ---- -10 ... 00001 @rm_xm rw=2 ? sse2
cvtdq2pd          ........ 11100110 - ---- -10 ... 00001 @rm_xx rw=2 msz=64 ? sse2

movsd             ........ 00010000 - ---- -11 ... 00001 @rm_xx rw=2 msz=64 ? sse2
movsd             ........ 00010001 - ---- -11 ... 00001 @mr_xx rw=2 msz=64 ? sse2
cvtsi2sd          ........ 00101010 - ---- -11 ... 00001 @rm_xr rw=2 msz=3 suffix=3 ? sse2
cvttsd2si         ........ 00101100 - ---- -11 ... 00001 @rm_rx rw=2 msz=64 ? sse2
cvtsd2si          ........ 00101101 - ---- -11 ... 00001 @rm_rx rw=2 msz=64 ? sse2
sqrtsd            ........ 01010001 - ---- -11 ... 00001 @rm_xx rw=2 msz=64 ? sse2
addsd             ........ 01011000 - ---- -11 ... 00001 @rm_xx msz=64 ? sse2
mulsd             ........ 01011001 - ---- -11 ... 00001 @rm_xx msz=64 ? sse2
cvtsd2ss          ........ 01011010 - ---- -11 ... 00001 @rm_xx msz=64 ? sse2
subsd             ........ 01011100 - ---- -11 ... 00001 @rm_xx msz=64 ? sse2
minsd             ........ 01011101 - ---- -11 ... 00001 @rm_xx msz=64 ? sse2
divsd             ........ 01011110 - ---- -11 ... 00001 @rm_xx msz=64 ? sse2
maxsd             ........ 01011111 - ---- -11 ... 00001 @rm_xx msz=64 ? sse2
pshuflw           ........ 01110000 - ---- -11 ... 00001 @rm_xx rw=2 uimm=8 ? sse2
cvtpd2dq          ........ 11100110 - ---- -11 ... 00001 @rm_xx rw=2 ? sse2

cmppd             ........ 11000010 - ---- 001 ... 00001 @rm_xx opc=8 ? sse2
cmpeqpd           00000000 11000010 - ---- 101 ... 00001 ? never
cmpltpd           00000001 11000010 - ---- 101 ... 00001 ? never
cmplepd           00000010 11000010 - ---- 101 ... 00001 ? never
cmpunordpd        00000011 11000010 - ---- 101 ... 00001 ? never
cmpneqpd          00000100 11000010 - ---- 101 ... 00001 ? never
cmpnltpd          00000101 11000010 - ---- 101 ... 00001 ? never
cmpnlepd          00000110 11000010 - ---- 101 ... 00001 ? never
cmpordpd          00000111 11000010 - ---- 101 ... 00001 ? never
cmpsd             ........ 11000010 - ---- 011 ... 00001 @rm_xx msz=64 opc=8 ? sse2
cmpeqsd           00000000 11000010 - ---- 111 ... 00001 ? never
cmpltsd           00000001 11000010 - ---- 111 ... 00001 ? never
cmplesd           00000010 11000010 - ---- 111 ... 00001 ? never
cmpunordsd        00000011 11000010 - ---- 111 ... 00001 ? never
cmpneqsd          00000100 11000010 - ---- 111 ... 00001 ? never
cmpnltsd          00000101 11000010 - ---- 111 ... 00001 ? never
cmpnlesd          00000110 11000010 - ---- 111 ... 00001 ? never
cmpordsd          00000111 11000010 - ---- 111 ... 00001 ? never

##############################################################################
# Extension SSE3
##############################################################################

palignr           ........ 00001111 - ---- -00 ... 00011 @rm_mm rw=2 uimm=8 ? sse3

palignr           ........ 00001111 - ---- -01 ... 00011 @rm_xx rw=2 uimm=8 ? sse3
haddpd            ........ 01111100 - ---- -01 ... 00001 @rm_xx ? sse3
hsubpd            ........ 01111101 - ---- -01 ... 00001 @rm_xx ? sse3
addsubpd          ........ 11010000 - ---- -01 ... 00001 @rm_xx ? sse3

movsldup          ........ 00010010 - ---- -10 ... 00001 @rm_xx rw=2 ? sse3
movshdup          ........ 00010110 - ---- -10 ... 00001 @rm_xx rw=2 ? sse3

movddup           ........ 00010010 - ---- -11 ... 00001 @rm_xx rw=2 msz=64 ? sse3
haddps            ........ 01111100 - ---- -11 ... 00001 @rm_xx ? sse3
hsubps            ........ 01111101 - ---- -11 ... 00001 @rm_xx ? sse3
addsubps          ........ 11010000 - ---- -11 ... 00001 @rm_xx ? sse3
lddqu             0....... 11110000 - ---- -11 ... 00001 no_ptr=1 @rm_xx rw=2 ? sse3
lddqu             10...... 11110000 - ---- -11 ... 00001 no_ptr=1 @rm_xx rw=2 ? sse3

##############################################################################
# Extension SSSE3
##############################################################################

pshufb            ........ 00000000 - ---- -00 ... 00010 @rm_mm ? ssse3
phaddw            ........ 00000001 - ---- -00 ... 00010 @rm_mm ? ssse3
phaddd            ........ 00000010 - ---- -00 ... 00010 @rm_mm ? ssse3
phaddsw           ........ 00000011 - ---- -00 ... 00010 @rm_mm ? ssse3
pmaddubsw         ........ 00000100 - ---- -00 ... 00010 @rm_mm ? ssse3
phsubw            ........ 00000101 - ---- -00 ... 00010 @rm_mm ? ssse3
phsubd            ........ 00000110 - ---- -00 ... 00010 @rm_mm ? ssse3
phsubsw           ........ 00000111 - ---- -00 ... 00010 @rm_mm ? ssse3
psignb            ........ 00001000 - ---- -00 ... 00010 @rm_mm ? ssse3
psignw            ........ 00001001 - ---- -00 ... 00010 @rm_mm ? ssse3
psignd            ........ 00001010 - ---- -00 ... 00010 @rm_mm ? ssse3
pmulhrsw          ........ 00001011 - ---- -00 ... 00010 @rm_mm ? ssse3
pabsb             ........ 00011100 - ---- -00 ... 00010 @rm_mm ? ssse3
pabsw             ........ 00011101 - ---- -00 ... 00010 @rm_mm ? ssse3
pabsd             ........ 00011110 - ---- -00 ... 00010 @rm_mm ? ssse3

pshufb            ........ 00000000 - ---- -01 ... 00010 @rm_xx ? ssse3
phaddw            ........ 00000001 - ---- -01 ... 00010 @rm_xx ? ssse3
phaddd            ........ 00000010 - ---- -01 ... 00010 @rm_xx ? ssse3
phaddsw           ........ 00000011 - ---- -01 ... 00010 @rm_xx ? ssse3
pmaddubsw         ........ 00000100 - ---- -01 ... 00010 @rm_xx ? ssse3
phsubw            ........ 00000101 - ---- -01 ... 00010 @rm_xx ? ssse3
phsubd            ........ 00000110 - ---- -01 ... 00010 @rm_xx ? ssse3
phsubsw           ........ 00000111 - ---- -01 ... 00010 @rm_xx ? ssse3
psignb            ........ 00001000 - ---- -01 ... 00010 @rm_xx ? ssse3
psignw            ........ 00001001 - ---- -01 ... 00010 @rm_xx ? ssse3
psignd            ........ 00001010 - ---- -01 ... 00010 @rm_xx ? ssse3
pmulhrsw          ........ 00001011 - ---- -01 ... 00010 @rm_xx ? ssse3
pabsb             ........ 00011100 - ---- -01 ... 00010 @rm_xx ? ssse3
pabsw             ........ 00011101 - ---- -01 ... 00010 @rm_xx ? ssse3
pabsd             ........ 00011110 - ---- -01 ... 00010 @rm_xx ? ssse3

##############################################################################
# Extension SSE4.1
##############################################################################

pblendvb          ........ 00010000 - ---- -01 ... 00010 @rm_xx @xmm0 ? sse4_1
blendvps          ........ 00010100 - ---- -01 ... 00010 @rm_xx @xmm0 ? sse4_1
blendvpd          ........ 00010101 - ---- -01 ... 00010 @rm_xx @xmm0 ? sse4_1
ptest             ........ 00010111 - ---- -01 ... 00010 @rm_xx rw=1 ? sse4_1
pmovsxbw          ........ 00100000 - ---- -01 ... 00010 @rm_xx rw=2 msz=64 ? sse4_1
pmovsxbd          ........ 00100001 - ---- -01 ... 00010 @rm_xx rw=2 msz=32 ? sse4_1
pmovsxbq          ........ 00100010 - ---- -01 ... 00010 @rm_xx rw=2 msz=16 ? sse4_1
pmovsxwd          ........ 00100011 - ---- -01 ... 00010 @rm_xx rw=2 msz=64 ? sse4_1
pmovsxwq          ........ 00100100 - ---- -01 ... 00010 @rm_xx rw=2 msz=32 ? sse4_1
pmovsxdq          ........ 00100101 - ---- -01 ... 00010 @rm_xx rw=2 msz=64 ? sse4_1
pmuldq            ........ 00101000 - ---- -01 ... 00010 @rm_xx ? sse4_1
pcmpeqq           ........ 00101001 - ---- -01 ... 00010 @rm_xx ? sse4_1
movntdqa          0....... 00101010 - ---- -01 ... 00010 @rm_xx rw=2 ? sse4_1
movntdqa          10...... 00101010 - ---- -01 ... 00010 @rm_xx rw=2 ? sse4_1
packusdw          ........ 00101011 - ---- -01 ... 00010 @rm_xx ? sse4_1
pmovzxbw          ........ 00110000 - ---- -01 ... 00010 @rm_xx rw=2 msz=64 ? sse4_1
pmovzxbd          ........ 00110001 - ---- -01 ... 00010 @rm_xx rw=2 msz=32 ? sse4_1
pmovzxbq          ........ 00110010 - ---- -01 ... 00010 @rm_xx rw=2 msz=16 ? sse4_1
pmovzxwd          ........ 00110011 - ---- -01 ... 00010 @rm_xx rw=2 msz=64 ? sse4_1
pmovzxwq          ........ 00110100 - ---- -01 ... 00010 @rm_xx rw=2 msz=32 ? sse4_1
pmovzxdq          ........ 00110101 - ---- -01 ... 00010 @rm_xx rw=2 msz=64 ? sse4_1
pminsb            ........ 00111000 - ---- -01 ... 00010 @rm_xx ? sse4_1
pminsd            ........ 00111001 - ---- -01 ... 00010 @rm_xx ? sse4_1
pminuw            ........ 00111010 - ---- -01 ... 00010 @rm_xx ? sse4_1
pminud            ........ 00111011 - ---- -01 ... 00010 @rm_xx ? sse4_1
pmaxsb            ........ 00111100 - ---- -01 ... 00010 @rm_xx ? sse4_1
pmaxsd            ........ 00111101 - ---- -01 ... 00010 @rm_xx ? sse4_1
pmaxuw            ........ 00111110 - ---- -01 ... 00010 @rm_xx ? sse4_1
pmaxud            ........ 00111111 - ---- -01 ... 00010 @rm_xx ? sse4_1
pmulld            ........ 01000000 - ---- -01 ... 00010 @rm_xx ? sse4_1
phminposuw        ........ 01000001 - ---- -01 ... 00010 @rm_xx rw=2 ? sse4_1

roundps           ........ 00001000 - ---- -01 ... 00011 @rm_xx rw=2 uimm=8 ? sse4_1
roundpd           ........ 00001001 - ---- -01 ... 00011 @rm_xx rw=2 uimm=8 ? sse4_1
roundss           ........ 00001010 - ---- -01 ... 00011 @rm_xx rw=2 uimm=8 msz=32 ? sse4_1
roundsd           ........ 00001011 - ---- -01 ... 00011 @rm_xx rw=2 uimm=8 msz=64 ? sse4_1
blendps           ........ 00001100 - ---- -01 ... 00011 @rm_xx uimm=8 ? sse4_1
blendpd           ........ 00001101 - ---- -01 ... 00011 @rm_xx uimm=8 ? sse4_1
pblendw           ........ 00001110 - ---- -01 ... 00011 @rm_xx uimm=8 ? sse4_1
pextrb            ........ 00010100 - ---- -01 ... 00011 @mr_rx rw=2 uimm=8 msz=8  bsz=32 ? sse4_1
pextrw            ........ 00010101 - ---- -01 ... 00011 @mr_rx rw=2 uimm=8 msz=16 bsz=32 ? sse4_1
pextrd            ........ 00010110 0 ---- -01 ... 00011 @mr_rx rw=2 uimm=8 msz=32 ? sse4_1
pextrq            ........ 00010110 1 ---- -01 ... 00011 @mr_rx rw=2 uimm=8 msz=64 ? sse4_1
extractps         ........ 00010111 - ---- -01 ... 00011 @mr_rx rw=2 uimm=8 msz=32 ? sse4_1
pinsrb            ........ 00100000 - ---- -01 ... 00011 @rm_xr rw=2 uimm=8 msz=8 bsz=32 ? sse4_1
insertps          ........ 00100001 - ---- -01 ... 00011 @rm_xx uimm=8 msz=32 ? sse4_1
pinsrd            ........ 00100010 0 ---- -01 ... 00011 @rm_xr rw=2 uimm=8 msz=32 ? sse4_1
pinsrq            ........ 00100010 1 ---- -01 ... 00011 @rm_xr rw=2 uimm=8 msz=64 ? sse4_1
dpps              ........ 01000000 - ---- -01 ... 00011 @rm_xx uimm=8 ? sse4_1
dppd              ........ 01000001 - ---- -01 ... 00011 @rm_xx uimm=8 ? sse4_1
mpsadbw           ........ 01000010 - ---- -01 ... 00011 @rm_xx uimm=8 ? sse4_1

##############################################################################
# Extension SSE4.2
##############################################################################

pcmpgtq           ........ 00110111 - ---- -01 ... 00010 @rm_xx ? sse4_2

pcmpestrm         ........ 01100000 - ---- -01 ... 00011 @rm_xx rw=1 uimm=8 ? sse4_2
pcmpestri         ........ 01100001 - ---- -01 ... 00011 @rm_xx rw=1 uimm=8 ? sse4_2
pcmpistrm         ........ 01100010 - ---- -01 ... 00011 @rm_xx rw=1 uimm=8 ? sse4_2
pcmpistri         ........ 01100011 - ---- -01 ... 00011 @rm_xx rw=1 uimm=8 ? sse4_2

##############################################################################
# BMI1
##############################################################################

tzcnt             ........ 10111100 - 10-- --- ... 00001 @rm_rr rw=2 suffix=1 ? bmi

##############################################################################
# Extension ADX
##############################################################################

adcx              ........ 11110110 0 ---- -01 ... 00010 @rm_rr rsz=32 msz=32 suffix=1 ? adx
adox              ........ 11110110 0 ---- -10 ... 00010 @rm_rr rsz=32 msz=32 suffix=1 ? adx
adcx              ........ 11110110 1 ---- -01 ... 00010 @rm_rr rsz=64 msz=64 suffix=1 ? adx
adox              ........ 11110110 1 ---- -10 ... 00010 @rm_rr rsz=64 msz=64 suffix=1 ? adx

##############################################################################
# Extension RTM
##############################################################################

xabort            11111000 11000110 - ---- --- ... 00000 uimm=8 ? rtm
xbeginw           11111000 11000111 - --1- --- ... 00000 rel=16 suffix=16 ? rtm
{
  xbegin          11111000 11000111 - --0- --- ... 00000 rel=32 suffix=64 ? rtm amd64
  xbegin          11111000 11000111 - --0- --- ... 00000 rel=32 suffix=32 ? rtm
}
xend              11010101 00000001 - ---- -00 ... 00001 ? rtm
xtest             11010110 00000001 - ---- -00 ... 00001 ? rtm_or_hle

##############################################################################
# Extension CET
##############################################################################

setssbsy          11101000 00000001 - ---- -10 ... 00001 ? cet_ss
saveprevssp       11101010 00000001 - ---- -10 ... 00001 ? cet_ss
rstorssp          0.101... 00000001 - ---- -10 ... 00001 @m_r rw=2 msz=64 ? cet_ss
rstorssp          10101... 00000001 - ---- -10 ... 00001 @m_r rw=2 msz=64 ? cet_ss
rdsspd            ..001... 00011110 0 ---- -10 ... 00001 @m_r rw=2 msz=32 ? cet_ss
rdsspq            ..001... 00011110 1 ---- -10 ... 00001 @m_r rw=2 msz=64 ? cet_ss
clrssbsy          0.110... 10101110 - 100- --- ... 00001 @m_r msz=64 ? cet_ss
clrssbsy          10110... 10101110 - 100- --- ... 00001 @m_r msz=64 ? cet_ss
incsspd           11101... 10101110 0 100- --- ... 00001 @m_r rw=2 msz=32 ? cet_ss
incsspq           11101... 10101110 1 100- --- ... 00001 @m_r rw=2 msz=64 ? cet_ss

wrussd            0....... 11110101 0 ---- -01 ... 00010 no_ptr=1 @mr_rr rw=2 msz=32 rsz=32 ? cet_ss
wrussd            10...... 11110101 0 ---- -01 ... 00010 no_ptr=1 @mr_rr rw=2 msz=32 rsz=32 ? cet_ss
wrussq            0....... 11110101 1 ---- -01 ... 00010 no_ptr=1 @mr_rr rw=2 msz=64 rsz=64 ? cet_ss
wrussq            10...... 11110101 1 ---- -01 ... 00010 no_ptr=1 @mr_rr rw=2 msz=64 rsz=64 ? cet_ss
wrssd             0....... 11110110 0 ---- -00 ... 00010 no_ptr=1 @mr_rr rw=2 msz=32 rsz=32 ? cet_ss
wrssd             10...... 11110110 0 ---- -00 ... 00010 no_ptr=1 @mr_rr rw=2 msz=32 rsz=32 ? cet_ss
wrssq             0....... 11110110 1 ---- -00 ... 00010 no_ptr=1 @mr_rr rw=2 msz=64 rsz=64 ? cet_ss
wrssq             10...... 11110110 1 ---- -00 ... 00010 no_ptr=1 @mr_rr rw=2 msz=64 rsz=64 ? cet_ss

endbr64           11111010 00011110 - ---- -10 ... 00001 ? cet_ibt
endbr32           11111011 00011110 - ---- -10 ... 00001 ? cet_ibt

##############################################################################
# Extension UINTR
##############################################################################

uiret             11101100 00000001 - ---- -10 ... 00001 ? uintr
testui            11101101 00000001 - ---- -10 ... 00001 ? uintr
clui              11101110 00000001 - ---- -10 ... 00001 ? uintr
stui              11101111 00000001 - ---- -10 ... 00001 ? uintr
senduipi          11110... 11000111 - 100- --- ... 00001 @m_r rw=1 msz=64 ? amd64 uintr

##############################################################################
# Extension WAITPKG
##############################################################################

tpause            11110... 10101110 - 001- --- --- 00001 @m_r rw=1 msz=32 ? waitpkg
umwait            11110... 10101110 - 010- --- ... 00001 @m_r rw=1 msz=32 ? waitpkg
umonitor          11110... 10101110 - 100- --- ... 00001 @m_r rw=1 msz=6  ? waitpkg

##############################################################################
# Extension OSPKE
##############################################################################

rdpkru            11101110 00000001 - ---- -00 ... 00001 ? ospke
wrpkru            11101111 00000001 - ---- -00 ... 00001 ? ospke

##############################################################################
# Extension AES
##############################################################################

aesimc            ........ 11011011 - ---- -01 ... 00010 @rm_xx rw=2 ? aes
aesenc            ........ 11011100 - ---- -01 ... 00010 @rm_xx ? aes
aesenclast        ........ 11011101 - ---- -01 ... 00010 @rm_xx ? aes
aesdec            ........ 11011110 - ---- -01 ... 00010 @rm_xx ? aes
aesdeclast        ........ 11011111 - ---- -01 ... 00010 @rm_xx ? aes
aeskeygenassist   ........ 11011111 - ---- -01 ... 00011 @rm_xx rw=2 uimm=8 ? aes

##############################################################################
# Extension AESKLE
##############################################################################

aesencwide128kl   0.000... 11011000 - ---- -10 ... 00010 no_ptr=1 @m_x rw=1 ? aeskle
aesencwide128kl   10000... 11011000 - ---- -10 ... 00010 no_ptr=1 @m_x rw=1 ? aeskle
aesdecwide128kl   0.001... 11011000 - ---- -10 ... 00010 no_ptr=1 @m_x rw=1 ? aeskle
aesdecwide128kl   10001... 11011000 - ---- -10 ... 00010 no_ptr=1 @m_x rw=1 ? aeskle
aesencwide256kl   0.010... 11011000 - ---- -10 ... 00010 no_ptr=1 @m_x rw=1 ? aeskle
aesencwide256kl   10010... 11011000 - ---- -10 ... 00010 no_ptr=1 @m_x rw=1 ? aeskle
aesdecwide256kl   0.011... 11011000 - ---- -10 ... 00010 no_ptr=1 @m_x rw=1 ? aeskle
aesdecwide256kl   10011... 11011000 - ---- -10 ... 00010 no_ptr=1 @m_x rw=1 ? aeskle
aesenc128kl       0....... 11011100 - ---- -10 ... 00010 no_ptr=1 @rm_xr ? aeskle
aesenc128kl       10...... 11011100 - ---- -10 ... 00010 no_ptr=1 @rm_xr ? aeskle
aesdec128kl       0....... 11011101 - ---- -10 ... 00010 no_ptr=1 @rm_xr ? aeskle
aesdec128kl       10...... 11011101 - ---- -10 ... 00010 no_ptr=1 @rm_xr ? aeskle
aesenc256kl       0....... 11011110 - ---- -10 ... 00010 no_ptr=1 @rm_xr ? aeskle
aesenc256kl       10...... 11011110 - ---- -10 ... 00010 no_ptr=1 @rm_xr ? aeskle
aesdec256kl       0....... 11011111 - ---- -10 ... 00010 no_ptr=1 @rm_xr ? aeskle
aesdec256kl       10...... 11011111 - ---- -10 ... 00010 no_ptr=1 @rm_xr ? aeskle
encodekey128      11...... 11111010 - ---- -10 ... 00010 @rm_rr rw=2 rsz=32 msz=32 ? aeskle
encodekey256      11...... 11111011 - ---- -10 ... 00010 @rm_rr rw=2 rsz=32 msz=32 ? aeskle

##############################################################################
# Extension MPX
##############################################################################

bndldx            0.0..... 00011010 - ---- -00 ... 00001 no_ptr=1 @br_w @m_r rw=1 msz=4 ? mpx
bndldx            100..... 00011010 - ---- -00 ... 00001 no_ptr=1 @br_w @m_r rw=1 msz=4 ? mpx
{
  bndmov          110..0.. 00011010 - ---- -01 ... 00001 no_ptr=1 @br_w @bm_r msz=4 ? mpx
  bndmov          ..0..... 00011010 - ---- -01 ... 00001 no_ptr=1 @br_w @m_r rw=1 msz=4 ? mpx
}
bndcl             ..0..... 00011010 - ---- -10 ... 00001 no_ptr=1 @br_w @m_r rw=1 msz=4 ? mpx
bndcu             ..0..... 00011010 - ---- -11 ... 00001 no_ptr=1 @br_w @m_r rw=1 msz=4 ? mpx
{
  bndmov          110..0.. 00011011 - ---- -01 ... 00001 no_ptr=1 @bm_w @br_r msz=4 ? mpx
  bndmov          ..0..... 00011011 - ---- -01 ... 00001 no_ptr=1 @m_r rw=2 @br_r msz=4 ? mpx
}
bndstx            ........ 00011011 - ---- -00 ... 00001 no_ptr=1 @m_r rw=2 @br_r msz=4 ? mpx
bndmk             0.0..... 00011011 - ---- -10 ... 00001 no_ptr=1 @br_w @m_r rw=1 msz=4 ? mpx
bndmk             100..... 00011011 - ---- -10 ... 00001 no_ptr=1 @br_w @m_r rw=1 msz=4 ? mpx
bndcn             ..0..... 00011011 - ---- -11 ... 00001 no_ptr=1 @br_w @m_r rw=1 msz=4 ? mpx

##############################################################################
# Extension SMAP
##############################################################################

clac              11001010 00000001 - ---- -00 ... 00001 ? smap
stac              11001011 00000001 - ---- -00 ... 00001 ? smap

##############################################################################
# Extension SHA
##############################################################################

sha1nexte         ........ 11001000 - ---- -00 ... 00010 @rm_xx ? sha
sha1msg1          ........ 11001001 - ---- -00 ... 00010 @rm_xx ? sha
sha1msg2          ........ 11001010 - ---- -00 ... 00010 @rm_xx ? sha
sha256rnds2       ........ 11001011 - ---- -00 ... 00010 @rm_xx @xmm0 ? sha
sha256msg1        ........ 11001100 - ---- -00 ... 00010 @rm_xx ? sha
sha1rnds4         ........ 11001100 - ---- -00 ... 00011 @rm_xx uimm=8 ? sha
sha256msg2        ........ 11001101 - ---- -00 ... 00010 @rm_xx ? sha

##############################################################################
# XSAVE
##############################################################################

xrstor            0.101... 10101110 0 000- --- --- 00001 no_ptr=1 @m_r rw=1 # TODO: ? xsave
xrstor            10101... 10101110 0 000- --- --- 00001 no_ptr=1 @m_r rw=1 # TODO: ? xsave
xsave             0.100... 10101110 0 000- --- --- 00001 no_ptr=1 @m_r # TODO: ? xsave
xsave             10100... 10101110 0 000- --- --- 00001 no_ptr=1 @m_r # TODO: ? xsave
xsaveopt          0.110... 10101110 0 000- --- --- 00001 no_ptr=1 @m_r # TODO: ? xsaveopt
xsaveopt          10110... 10101110 0 000- --- --- 00001 no_ptr=1 @m_r # TODO: ? xsaveopt
xrstor64          0.101... 10101110 1 000- --- --- 00001 no_ptr=1 @m_r rw=1 # TODO: ? xsave
xrstor64          10101... 10101110 1 000- --- --- 00001 no_ptr=1 @m_r rw=1 # TODO: ? xsave
xsave64           0.100... 10101110 1 000- --- --- 00001 no_ptr=1 @m_r # TODO: ? xsave
xsave64           10100... 10101110 1 000- --- --- 00001 no_ptr=1 @m_r # TODO: ? xsave
xsaveopt64        0.110... 10101110 1 000- --- --- 00001 no_ptr=1 @m_r # TODO: ? xsaveopt
xsaveopt64        10110... 10101110 1 000- --- --- 00001 no_ptr=1 @m_r # TODO: ? xsaveopt
xrstors           0.011... 11000111 0 000- --- --- 00001 no_ptr=1 @m_r rw=1 # TODO: ? xss
xrstors           10011... 11000111 0 000- --- --- 00001 no_ptr=1 @m_r rw=1 # TODO: ? xss
xsavec            0.100... 11000111 0 000- --- --- 00001 no_ptr=1 @m_r rw=2 # TODO: ? xsavec
xsavec            10100... 11000111 0 000- --- --- 00001 no_ptr=1 @m_r rw=2 # TODO: ? xsavec
xsaves            0.101... 11000111 0 000- --- --- 00001 no_ptr=1 @m_r rw=2 # TODO: ? xss
xsaves            10101... 11000111 0 000- --- --- 00001 no_ptr=1 @m_r rw=2 # TODO: ? xss
xrstors64         0.011... 11000111 1 000- --- --- 00001 no_ptr=1 @m_r rw=1 # TODO: ? xss
xrstors64         10011... 11000111 1 000- --- --- 00001 no_ptr=1 @m_r rw=1 # TODO: ? xss
xsavec64          0.100... 11000111 1 000- --- --- 00001 no_ptr=1 @m_r rw=2 # TODO: ? xsavec
xsavec64          10100... 11000111 1 000- --- --- 00001 no_ptr=1 @m_r rw=2 # TODO: ? xsavec
xsaves64          0.101... 11000111 1 000- --- --- 00001 no_ptr=1 @m_r rw=2 # TODO: ? xss
xsaves64          10101... 11000111 1 000- --- --- 00001 no_ptr=1 @m_r rw=2 # TODO: ? xss

##############################################################################
# Extension MOVBE
##############################################################################

movbe             0....... 11110000 - 00-- --- ... 00010 @rm_rr rw=2 suffix=1 ? movbe
movbe             10...... 11110000 - 00-- --- ... 00010 @rm_rr rw=2 suffix=1 ? movbe
movbe             0....... 11110001 - 00-- --- ... 00010 @mr_rr rw=2 suffix=1 ? movbe
movbe             10...... 11110001 - 00-- --- ... 00010 @mr_rr rw=2 suffix=1 ? movbe

##############################################################################
# Extension GFNI
##############################################################################

gf2p8mulb         ........ 11001111 - ---- -01 ... 00010 @rm_xx ? gfni
gf2p8affineqb     ........ 11001110 - ---- -01 ... 00011 @rm_xx uimm=8 ? gfni
gf2p8affineinvqb  ........ 11001111 - ---- -01 ... 00011 @rm_xx uimm=8 ? gfni

##############################################################################
# Uncategorized
##############################################################################

sldt              0.000... 00000000 - 000- --- --- 00001 @m_r rw=2 msz=16
sldt              10000... 00000000 - 000- --- --- 00001 @m_r rw=2 msz=16

sgdt              0.000... 00000001 - 000- --- --- 00001 no_ptr=1 @m_r rw=2 msz=5
sgdt              10000... 00000001 - 000- --- --- 00001 no_ptr=1 @m_r rw=2 msz=5
sidt              0.001... 00000001 - 000- --- --- 00001 no_ptr=1 @m_r rw=2 msz=5
sidt              10001... 00000001 - 000- --- --- 00001 no_ptr=1 @m_r rw=2 msz=5
xgetbv            11010000 00000001 - 000- --- --- 00001
xsetbv            11010001 00000001 - 000- --- --- 00001

xsusldtrk         11101000 00000001 - ---- -11 --- 00001 # TODO: ? tsxldtrk
xresldtrk         11101001 00000001 - ---- -11 --- 00001 # TODO: ? tsxldtrk

wrmsr                      00110000 - ---- -00 ... 00001

serialize         11101000 00000001 - ---- -00 ... 00001 ? serialize
swapgs            11111000 00000001 - ---- -00 --- 00001 ? amd64

{
  smsw            11100... 00000001 - 00-- --- --- 00001 @m_r rw=2
  smsw            ..100... 00000001 - 00-- --- --- 00001 @m_r rw=2 msz=16
}

pconfig           11000101 00000001 - 00-- --- ... 00001 # TODO: ? pconfig

# TODO: prefetch* check extension
prefetch          ..000... 00001101 - ---- -00 ... 00001 @m_r rw=1 msz=8
prefetchw         ..001... 00001101 - ---- -00 ... 00001 @m_r rw=1 msz=8
prefetchnta       ..000... 00011000 - ---- -00 ... 00001 @m_r rw=1 msz=8
prefetcht0        ..001... 00011000 - ---- -00 ... 00001 @m_r rw=1 msz=8
prefetcht1        ..010... 00011000 - ---- -00 ... 00001 @m_r rw=1 msz=8
prefetcht2        ..011... 00011000 - ---- -00 ... 00001 @m_r rw=1 msz=8

rdtsc                      00110001 - ---- -00 ... 00001 ? tsc
monitor           11001000 00000001 - ---- -00 ... 00001
mwait             11001001 00000001 - ---- -00 ... 00001
rdtscp            11111001 00000001 - ---- -00 ... 00001 ? rdtscp

mcommit           11111010 00000001 - ---- -10 ... 00001 ? mcommit
# TODO: monitorx %rax,%ecx,%edx
monitorx          11111010 00000001 - ---- -00 ... 00001 ? monitorx
# TODO: mwaitx %eax,%ecx,%ebx
mwaitx            11111011 00000001 - ---- -00 ... 00001 ? monitorx

syscall                    00000101 - ---- -00 ... 00001
ud2                        00001011 - ---- -00 ... 00001
{
  nop             ..000... 00011111 0 --1- --- ... 00001 @m_r rw=2 suffix=-16
  nop             ..000... 00011111 - ---- --- ... 00001 @m_r rw=2 suffix=1
}

cpuid                      10100010 - ---- -00 ... 00001 ? cpuid
popcnt            ........ 10111000 - 10-- --- ... 00001 @rm_rr rw=2 suffix=1 ? popcnt
lzcnt             ........ 10111101 - 10-- --- ... 00001 @rm_rr rw=2 suffix=1 ? lzcnt

cmpxchg8b         0.001... 11000111 0 ---- -00 ... 00001 @m_r msz=64  ? cmpxchg8b
cmpxchg8b         10001... 11000111 0 ---- -00 ... 00001 @m_r msz=64  ? cmpxchg8b
cmpxchg16b        0.001... 11000111 1 ---- -00 ... 00001 @m_r msz=128 ? cmpxchg16b
cmpxchg16b        10001... 11000111 1 ---- -00 ... 00001 @m_r msz=128 ? cmpxchg16b

cldemote          0.000... 00011100 - ---- -00 ... 00001 @m_r rw=2 msz=8 # TODO: ? cldemote
cldemote          10000... 00011100 - ---- -00 ... 00001 @m_r rw=2 msz=8 # TODO: ? cldemote

clwb              0.110... 10101110 - 001- --- ... 00001 @m_r rw=2 msz=8 # TODO: ? clwb
clwb              10110... 10101110 - 001- --- ... 00001 @m_r rw=2 msz=8 # TODO: ? clwb

movdir64b         0....... 11111000 - ---- -01 ... 00010 no_ptr=1 @rm_rr rw=2 rsz=5 msz=8 # TODO: ? movdir64b
movdir64b         10...... 11111000 - ---- -01 ... 00010 no_ptr=1 @rm_rr rw=2 rsz=5 msz=8 # TODO: ? movdir64b

movdiri           0....... 11111001 - ---- -00 ... 00010 @mr_rr rw=2 suffix=1 # TODO: ? movdiri
movdiri           10...... 11111001 - ---- -00 ... 00010 @mr_rr rw=2 suffix=1 # TODO: ? movdiri

enqcmd            0....... 11111000 - ---- -11 ... 00010 no_ptr=1 @rm_rr rw=2 rsz=64 msz=512 # TODO: ? enqcmd
enqcmd            10...... 11111000 - ---- -11 ... 00010 no_ptr=1 @rm_rr rw=2 rsz=64 msz=512 # TODO: ? enqcmd
enqcmds           0....... 11111000 - ---- -10 ... 00010 no_ptr=1 @rm_rr rw=2 rsz=64 msz=512 # TODO: ? enqcmd
enqcmds           10...... 11111000 - ---- -10 ... 00010 no_ptr=1 @rm_rr rw=2 rsz=64 msz=512 # TODO: ? enqcmd

pclmulqdq         ........ 01000100 - ---- 001 ... 00011 @rm_xx opc=8 ? pclmulqdq
pclmullqlqdq      00000000 01000100 - ---- 101 ... 00011 ? never
pclmulhqlqdq      00000001 01000100 - ---- 101 ... 00011 ? never
pclmullqhqdq      00010000 01000100 - ---- 101 ... 00011 ? never
pclmulhqhqdq      00010001 01000100 - ---- 101 ... 00011 ? never

# TODO: ptwrite

rdfsbase          11000... 10101110 - ---- -10 ... 00001 @m_r rw=2 msz=3 ? fsgsbase
rdgsbase          11001... 10101110 - ---- -10 ... 00001 @m_r rw=2 msz=3 ? fsgsbase
wrfsbase          11010... 10101110 - ---- -10 ... 00001 @m_r rw=2 msz=3 ? fsgsbase
wrgsbase          11011... 10101110 - ---- -10 ... 00001 @m_r rw=2 msz=3 ? fsgsbase

rdmsr                      00110010 - ---- -00 --- 00001
rdpmc                      00110011 - ---- -00 --- 00001
rsm                        10101010 - ---- -00 --- 00001

rdrand            11110... 11000111 - 00-- --- ... 00001 @m_r rw=2 ? rdrand
rdseed            11111... 11000111 - 00-- --- ... 00001 @m_r rw=2 ? rdseed
rdpid             11111... 11000111 - 1--- --- ... 00001 @m_r rw=2 msz=5 ? rdpid

{
  str             11001... 00000000 . 00-- --- ... 00001 @m_r rw=2
  str             ..001... 00000000 . 00-- --- ... 00001 @m_r rw=2 msz=16
}

sysretd                    00000111 0 ---- -00 --- 00001
sysretq                    00000111 1 ---- -00 --- 00001
sysenter                   00110100 - ---- -00 --- 00001
sysexitd                   00110101 0 ---- -00 --- 00001
sysexitq                   00110101 1 ---- -00 --- 00001

{
  verr            11100... 00000000 - ---- -00 ... 00001 @m_r rw=1 msz=32
  verr            ..100... 00000000 - ---- -00 ... 00001 @m_r rw=1 msz=16
}
{
  verw            11101... 00000000 - ---- -00 ... 00001 @m_r rw=1 msz=32
  verw            ..101... 00000000 - ---- -00 ... 00001 @m_r rw=1 msz=16
}

wbinvd                     00001001 - 000- --- --- 00001
wbnoinvd                   00001001 - 100- --- --- 00001 ? wbnoinvd
